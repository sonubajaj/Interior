var swfobject=function(){var E="undefined",s="object",T="Shockwave Flash",X="ShockwaveFlash.ShockwaveFlash",r="application/x-shockwave-flash",S="SWFObjectExprInst",y="onreadystatechange",P=window,j=document,u=navigator,U=false,V=[h],p=[],O=[],J=[],m,R,F,C,K=false,a=false,o,H,n=true,N=function(){var ab=typeof j.getElementById!=E&&typeof j.getElementsByTagName!=E&&typeof j.createElement!=E,ai=u.userAgent.toLowerCase(),Z=u.platform.toLowerCase(),af=Z?/win/.test(Z):/win/.test(ai),ad=Z?/mac/.test(Z):/mac/.test(ai),ag=/webkit/.test(ai)?parseFloat(ai.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):false,Y=!+"\v1",ah=[0,0,0],ac=null;if(typeof u.plugins!=E&&typeof u.plugins[T]==s){ac=u.plugins[T].description;if(ac&&!(typeof u.mimeTypes!=E&&u.mimeTypes[r]&&!u.mimeTypes[r].enabledPlugin)){U=true;Y=false;ac=ac.replace(/^.*\s+(\S+\s+\S+$)/,"$1");ah[0]=parseInt(ac.replace(/^(.*)\..*$/,"$1"),10);ah[1]=parseInt(ac.replace(/^.*\.(.*)\s.*$/,"$1"),10);ah[2]=/[a-zA-Z]/.test(ac)?parseInt(ac.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0}}else{if(typeof P.ActiveXObject!=E){try{var ae=new ActiveXObject(X);if(ae){ac=ae.GetVariable("$version");if(ac){Y=true;ac=ac.split(" ")[1].split(",");ah=[parseInt(ac[0],10),parseInt(ac[1],10),parseInt(ac[2],10)]}}}catch(aa){}}}return{w3:ab,pv:ah,wk:ag,ie:Y,win:af,mac:ad}}(),k=function(){if(!N.w3){return}if((typeof j.readyState!=E&&j.readyState=="complete")||(typeof j.readyState==E&&(j.getElementsByTagName("body")[0]||j.body))){f()}if(!K){if(typeof j.addEventListener!=E){j.addEventListener("DOMContentLoaded",f,false)}if(N.ie&&N.win){j.attachEvent(y,function(){if(j.readyState=="complete"){j.detachEvent(y,arguments.callee);f()}});if(P==top){(function(){if(K){return}try{j.documentElement.doScroll("left")}catch(Y){setTimeout(arguments.callee,0);return}f()})()}}if(N.wk){(function(){if(K){return}if(!/loaded|complete/.test(j.readyState)){setTimeout(arguments.callee,0);return}f()})()}t(f)}}();function f(){if(K){return}try{var aa=j.getElementsByTagName("body")[0].appendChild(D("span"));aa.parentNode.removeChild(aa)}catch(ab){return}K=true;var Y=V.length;for(var Z=0;Z<Y;Z++){V[Z]()}}function L(Y){if(K){Y()}else{V[V.length]=Y}}function t(Z){if(typeof P.addEventListener!=E){P.addEventListener("load",Z,false)}else{if(typeof j.addEventListener!=E){j.addEventListener("load",Z,false)}else{if(typeof P.attachEvent!=E){i(P,"onload",Z)}else{if(typeof P.onload=="function"){var Y=P.onload;P.onload=function(){Y();Z()}}else{P.onload=Z}}}}}function h(){if(false){W()}else{I()}}function W(){var Y=j.getElementsByTagName("body")[0];var ab=D(s);ab.setAttribute("type",r);var aa=Y.appendChild(ab);if(aa){var Z=0;(function(){if(typeof aa.GetVariable!=E){var ac=aa.GetVariable("$version");if(ac){ac=ac.split(" ")[1].split(",");N.pv=[parseInt(ac[0],10),parseInt(ac[1],10),parseInt(ac[2],10)]}}else{if(Z<10){Z++;setTimeout(arguments.callee,10);return}}Y.removeChild(ab);aa=null;I()})()}else{I()}}function I(){var ah=p.length;if(ah>0){for(var ag=0;ag<ah;ag++){var Z=p[ag].id;var ac=p[ag].callbackFn;var ab={success:false,id:Z};if(N.pv[0]>0){var af=c(Z);if(af){if(G(p[ag].swfVersion)&&!(N.wk&&N.wk<312)){x(Z,true);if(ac){ab.success=true;ab.ref=A(Z);ac(ab)}}else{if(p[ag].expressInstall&&B()){var aj={};aj.data=p[ag].expressInstall;aj.width=af.getAttribute("width")||"0";aj.height=af.getAttribute("height")||"0";if(af.getAttribute("class")){aj.styleclass=af.getAttribute("class")}if(af.getAttribute("align")){aj.align=af.getAttribute("align")}var ai={};var Y=af.getElementsByTagName("param");var ad=Y.length;for(var ae=0;ae<ad;ae++){if(Y[ae].getAttribute("name").toLowerCase()!="movie"){ai[Y[ae].getAttribute("name")]=Y[ae].getAttribute("value")}}Q(aj,ai,Z,ac)}else{q(af);if(ac){ac(ab)}}}}}else{x(Z,true);if(ac){var aa=A(Z);if(aa&&typeof aa.SetVariable!=E){ab.success=true;ab.ref=aa}ac(ab)}}}}}function A(ab){var Y=null;var Z=c(ab);if(Z&&Z.nodeName=="OBJECT"){if(typeof Z.SetVariable!=E){Y=Z}else{var aa=Z.getElementsByTagName(s)[0];if(aa){Y=aa}}}return Y}function B(){return !a&&G("6.0.65")&&(N.win||N.mac)&&!(N.wk&&N.wk<312)}function Q(ab,ac,Y,aa){a=true;F=aa||null;C={success:false,id:Y};var af=c(Y);if(af){if(af.nodeName=="OBJECT"){m=g(af);R=null}else{m=af;R=Y}ab.id=S;if(typeof ab.width==E||(!/%$/.test(ab.width)&&parseInt(ab.width,10)<310)){ab.width="310"}if(typeof ab.height==E||(!/%$/.test(ab.height)&&parseInt(ab.height,10)<137)){ab.height="137"}j.title=j.title.slice(0,47)+" - Flash Player Installation";var ae=N.ie&&N.win?"ActiveX":"PlugIn",ad="MMredirectURL="+P.location.toString().replace(/&/g,"%26")+"&MMplayerType="+ae+"&MMdoctitle="+j.title;if(typeof ac.flashvars!=E){ac.flashvars+="&"+ad}else{ac.flashvars=ad}if(N.ie&&N.win&&af.readyState!=4){var Z=D("div");Y+="SWFObjectNew";Z.setAttribute("id",Y);af.parentNode.insertBefore(Z,af);af.style.display="none";(function(){if(af.readyState==4){af.parentNode.removeChild(af)}else{setTimeout(arguments.callee,10)}})()}v(ab,ac,Y)}}function q(Z){if(N.ie&&N.win&&Z.readyState!=4){var Y=D("div");Z.parentNode.insertBefore(Y,Z);Y.parentNode.replaceChild(g(Z),Y);Z.style.display="none";(function(){if(Z.readyState==4){Z.parentNode.removeChild(Z)}else{setTimeout(arguments.callee,10)}})()}else{Z.parentNode.replaceChild(g(Z),Z)}}function g(ad){var ab=D("div");if(N.win&&N.ie){ab.innerHTML=ad.innerHTML}else{var Z=ad.getElementsByTagName(s)[0];if(Z){var ae=Z.childNodes;if(ae){var Y=ae.length;for(var aa=0;aa<Y;aa++){if(!(ae[aa].nodeType==1&&ae[aa].nodeName=="PARAM")&&!(ae[aa].nodeType==8)){ab.appendChild(ae[aa].cloneNode(true))}}}}}return ab}function v(aj,ah,Z){var Y,ab=c(Z);if(N.wk&&N.wk<312){return Y}if(ab){if(typeof aj.id==E){aj.id=Z}if(N.ie&&N.win){var ai="";for(var af in aj){if(aj[af]!=Object.prototype[af]){if(af.toLowerCase()=="data"){ah.movie=aj[af]}else{if(af.toLowerCase()=="styleclass"){ai+=' class="'+aj[af]+'"'}else{if(af.toLowerCase()!="classid"){ai+=" "+af+'="'+aj[af]+'"'}}}}}var ag="";for(var ae in ah){if(ah[ae]!=Object.prototype[ae]){ag+='<param name="'+ae+'" value="'+ah[ae]+'" />'}}ab.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+ai+">"+ag+"</object>";O[O.length]=aj.id;Y=c(aj.id)}else{var aa=D(s);aa.setAttribute("type",r);for(var ad in aj){if(aj[ad]!=Object.prototype[ad]){if(ad.toLowerCase()=="styleclass"){aa.setAttribute("class",aj[ad])}else{if(ad.toLowerCase()!="classid"){aa.setAttribute(ad,aj[ad])}}}}for(var ac in ah){if(ah[ac]!=Object.prototype[ac]&&ac.toLowerCase()!="movie"){e(aa,ac,ah[ac])}}ab.parentNode.replaceChild(aa,ab);Y=aa}}return Y}function e(aa,Y,Z){var ab=D("param");ab.setAttribute("name",Y);ab.setAttribute("value",Z);aa.appendChild(ab)}function z(Z){var Y=c(Z);if(Y&&Y.nodeName=="OBJECT"){if(N.ie&&N.win){Y.style.display="none";(function(){if(Y.readyState==4){b(Z)}else{setTimeout(arguments.callee,10)}})()}else{Y.parentNode.removeChild(Y)}}}function b(aa){var Z=c(aa);if(Z){for(var Y in Z){if(typeof Z[Y]=="function"){Z[Y]=null}}Z.parentNode.removeChild(Z)}}function c(aa){var Y=null;try{Y=j.getElementById(aa)}catch(Z){}return Y}function D(Y){return j.createElement(Y)}function i(aa,Y,Z){aa.attachEvent(Y,Z);J[J.length]=[aa,Y,Z]}function G(aa){var Z=N.pv,Y=aa.split(".");Y[0]=parseInt(Y[0],10);Y[1]=parseInt(Y[1],10)||0;Y[2]=parseInt(Y[2],10)||0;return(Z[0]>Y[0]||(Z[0]==Y[0]&&Z[1]>Y[1])||(Z[0]==Y[0]&&Z[1]==Y[1]&&Z[2]>=Y[2]))?true:false}function w(ad,Z,ae,ac){if(N.ie&&N.mac){return}var ab=j.getElementsByTagName("head")[0];if(!ab){return}var Y=(ae&&typeof ae=="string")?ae:"screen";if(ac){o=null;H=null}if(!o||H!=Y){var aa=D("style");aa.setAttribute("type","text/css");aa.setAttribute("media",Y);o=ab.appendChild(aa);if(N.ie&&N.win&&typeof j.styleSheets!=E&&j.styleSheets.length>0){o=j.styleSheets[j.styleSheets.length-1]}H=Y}if(N.ie&&N.win){if(o&&typeof o.addRule==s){o.addRule(ad,Z)}}else{if(o&&typeof j.createTextNode!=E){o.appendChild(j.createTextNode(ad+" {"+Z+"}"))}}}function x(aa,Y){if(!n){return}var Z=Y?"visible":"hidden";if(K&&c(aa)){c(aa).style.visibility=Z}else{w("#"+aa,"visibility:"+Z)}}function M(Z){var aa=/[\\\"<>\.;]/;var Y=aa.exec(Z)!=null;return Y&&typeof encodeURIComponent!=E?encodeURIComponent(Z):Z}var d=function(){if(N.ie&&N.win){window.attachEvent("onunload",function(){var ad=J.length;for(var ac=0;ac<ad;ac++){J[ac][0].detachEvent(J[ac][1],J[ac][2])}var aa=O.length;for(var ab=0;ab<aa;ab++){z(O[ab])}for(var Z in N){N[Z]=null}N=null;for(var Y in swfobject){swfobject[Y]=null}swfobject=null})}}();return{registerObject:function(ac,Y,ab,aa){if(N.w3&&ac&&Y){var Z={};Z.id=ac;Z.swfVersion=Y;Z.expressInstall=ab;Z.callbackFn=aa;p[p.length]=Z;x(ac,false)}else{if(aa){aa({success:false,id:ac})}}},getObjectById:function(Y){if(N.w3){return A(Y)}},embedSWF:function(ac,ai,af,ah,Z,ab,aa,ae,ag,ad){var Y={success:false,id:ai};if(N.w3&&!(N.wk&&N.wk<312)&&ac&&ai&&af&&ah&&Z){x(ai,false);L(function(){af+="";ah+="";var ak={};if(ag&&typeof ag===s){for(var am in ag){ak[am]=ag[am]}}ak.data=ac;ak.width=af;ak.height=ah;var an={};if(ae&&typeof ae===s){for(var al in ae){an[al]=ae[al]}}if(aa&&typeof aa===s){for(var aj in aa){if(typeof an.flashvars!=E){an.flashvars+="&"+aj+"="+aa[aj]}else{an.flashvars=aj+"="+aa[aj]}}}if(G(Z)){var ao=v(ak,an,ai);if(ak.id==ai){x(ai,true)}Y.success=true;Y.ref=ao}else{if(ab&&B()){ak.data=ab;Q(ak,an,ai,ad);return}else{x(ai,true)}}if(ad){ad(Y)}})}else{if(ad){ad(Y)}}},switchOffAutoHideShow:function(){n=false},ua:N,getFlashPlayerVersion:function(){return{major:N.pv[0],minor:N.pv[1],release:N.pv[2]}},hasFlashPlayerVersion:G,createSWF:function(aa,Z,Y){if(N.w3){return v(aa,Z,Y)}else{return undefined}},showExpressInstall:function(aa,ab,Y,Z){if(N.w3&&B()){Q(aa,ab,Y,Z)}},removeSWF:function(Y){if(N.w3){z(Y)}},createCSS:function(ab,aa,Z,Y){if(N.w3){w(ab,aa,Z,Y)}},addDomLoadEvent:L,addLoadEvent:t,getQueryParamValue:function(ab){var aa=j.location.search||j.location.hash;if(aa){if(/\?/.test(aa)){aa=aa.split("?")[1]}if(ab==null){return M(aa)}var Z=aa.split("&");for(var Y=0;Y<Z.length;Y++){if(Z[Y].substring(0,Z[Y].indexOf("="))==ab){return M(Z[Y].substring((Z[Y].indexOf("=")+1)))}}}return""},expressInstallCallback:function(){if(a){var Y=c(S);if(Y&&m){Y.parentNode.replaceChild(m,Y);if(R){x(R,true);if(N.ie&&N.win){m.style.display="block"}}if(F){F(C)}}a=false}}}}();(function(){if(window.WEB_SOCKET_FORCE_FLASH){}else{if(window.WebSocket){return}else{if(window.MozWebSocket){window.WebSocket=MozWebSocket;return}}}var a;if(window.WEB_SOCKET_LOGGER){a=WEB_SOCKET_LOGGER}else{if(window.console&&window.console.log&&window.console.error){a=window.console}else{a={log:function(){},error:function(){}}}}if(swfobject.getFlashPlayerVersion().major<10){a.error("Flash Player >= 10.0.0 is required.");return}if(location.protocol=="file:"){a.error("WARNING: web-socket-js doesn't work in file:///... URL unless you set Flash Security Settings properly. Open the page via Web server i.e. http://...")}window.WebSocket=function(d,e,c,g,f){var b=this;b.__id=WebSocket.__nextId++;WebSocket.__instances[b.__id]=b;b.readyState=WebSocket.CONNECTING;b.bufferedAmount=0;b.__events={};if(!e){e=[]}else{if(typeof e=="string"){e=[e]}}b.__createTask=setTimeout(function(){WebSocket.__addTask(function(){b.__createTask=null;WebSocket.__flash.create(b.__id,d,e,c||null,g||0,f||null)})},0)};WebSocket.prototype.send=function(c){if(this.readyState==WebSocket.CONNECTING){throw"INVALID_STATE_ERR: Web Socket connection has not been established"}var b=WebSocket.__flash.send(this.__id,encodeURIComponent(c));if(b<0){return true}else{this.bufferedAmount+=b;return false}};WebSocket.prototype.close=function(){if(this.__createTask){clearTimeout(this.__createTask);this.__createTask=null;this.readyState=WebSocket.CLOSED;return}if(this.readyState==WebSocket.CLOSED||this.readyState==WebSocket.CLOSING){return}this.readyState=WebSocket.CLOSING;WebSocket.__flash.close(this.__id)};WebSocket.prototype.addEventListener=function(c,d,b){if(!(c in this.__events)){this.__events[c]=[]}this.__events[c].push(d)};WebSocket.prototype.removeEventListener=function(e,f,b){if(!(e in this.__events)){return}var d=this.__events[e];for(var c=d.length-1;c>=0;--c){if(d[c]===f){d.splice(c,1);break}}};WebSocket.prototype.dispatchEvent=function(e){var c=this.__events[e.type]||[];for(var b=0;b<c.length;++b){c[b](e)}var d=this["on"+e.type];if(d){d.apply(this,[e])}};WebSocket.prototype.__handleEvent=function(d){if("readyState" in d){this.readyState=d.readyState}if("protocol" in d){this.protocol=d.protocol}var b;if(d.type=="open"||d.type=="error"){b=this.__createSimpleEvent(d.type)}else{if(d.type=="close"){b=this.__createSimpleEvent("close");b.wasClean=d.wasClean?true:false;b.code=d.code;b.reason=d.reason}else{if(d.type=="message"){var c=decodeURIComponent(d.message);b=this.__createMessageEvent("message",c)}else{throw"unknown event type: "+d.type}}}this.dispatchEvent(b)};WebSocket.prototype.__createSimpleEvent=function(b){if(document.createEvent&&window.Event){var c=document.createEvent("Event");c.initEvent(b,false,false);return c}else{return{type:b,bubbles:false,cancelable:false}}};WebSocket.prototype.__createMessageEvent=function(b,d){if(document.createEvent&&window.MessageEvent&&!window.opera){var c=document.createEvent("MessageEvent");c.initMessageEvent("message",false,false,d,null,null,window,null);return c}else{return{type:b,data:d,bubbles:false,cancelable:false}}};WebSocket.CONNECTING=0;WebSocket.OPEN=1;WebSocket.CLOSING=2;WebSocket.CLOSED=3;WebSocket.__isFlashImplementation=true;WebSocket.__initialized=false;WebSocket.__flash=null;WebSocket.__instances={};WebSocket.__tasks=[];WebSocket.__nextId=0;WebSocket.loadFlashPolicyFile=function(b){WebSocket.__addTask(function(){WebSocket.__flash.loadManualPolicyFile(b)})};WebSocket.__initialize=function(){if(WebSocket.__initialized){return}WebSocket.__initialized=true;if(WebSocket.__swfLocation){window.WEB_SOCKET_SWF_LOCATION=WebSocket.__swfLocation}if(!window.WEB_SOCKET_SWF_LOCATION){a.error("[WebSocket] set WEB_SOCKET_SWF_LOCATION to location of WebSocketMain.swf");return}if(!window.WEB_SOCKET_SUPPRESS_CROSS_DOMAIN_SWF_ERROR&&!WEB_SOCKET_SWF_LOCATION.match(/(^|\/)WebSocketMainInsecure\.swf(\?.*)?$/)&&WEB_SOCKET_SWF_LOCATION.match(/^\w+:\/\/([^\/]+)/)){var d=RegExp.$1;if(location.host!=d){a.error("[WebSocket] You must host HTML and WebSocketMain.swf in the same host ('"+location.host+"' != '"+d+"'). See also 'How to host HTML file and SWF file in different domains' section in README.md. If you use WebSocketMainInsecure.swf, you can suppress this message by WEB_SOCKET_SUPPRESS_CROSS_DOMAIN_SWF_ERROR = true;")}}var b=document.createElement("div");b.id="webSocketContainer";b.style.position="absolute";if(WebSocket.__isFlashLite()){b.style.left="0px";b.style.top="0px"}else{b.style.left="-100px";b.style.top="-100px"}var c=document.createElement("div");c.id="webSocketFlash";b.appendChild(c);document.body.appendChild(b);swfobject.embedSWF(WEB_SOCKET_SWF_LOCATION,"webSocketFlash","1","1","10.0.0",null,null,{hasPriority:true,swliveconnect:true,allowScriptAccess:"always"},null,function(f){if(!f.success){a.error("[WebSocket] swfobject.embedSWF failed")}})};WebSocket.__onFlashInitialized=function(){setTimeout(function(){WebSocket.__flash=document.getElementById("webSocketFlash");WebSocket.__flash.setCallerUrl(location.href);WebSocket.__flash.setDebug(!!window.WEB_SOCKET_DEBUG);for(var b=0;b<WebSocket.__tasks.length;++b){WebSocket.__tasks[b]()}WebSocket.__tasks=[]},0)};WebSocket.__onFlashEvent=function(){setTimeout(function(){try{var c=WebSocket.__flash.receiveEvents();for(var b=0;b<c.length;++b){WebSocket.__instances[c[b].webSocketId].__handleEvent(c[b])}}catch(d){a.error(d)}},0);return true};WebSocket.__log=function(b){a.log(decodeURIComponent(b))};WebSocket.__error=function(b){a.error(decodeURIComponent(b))};WebSocket.__addTask=function(b){if(WebSocket.__flash){b()}else{WebSocket.__tasks.push(b)}};WebSocket.__isFlashLite=function(){if(!window.navigator||!window.navigator.mimeTypes){return false}var b=window.navigator.mimeTypes["application/x-shockwave-flash"];if(!b||!b.enabledPlugin||!b.enabledPlugin.filename){return false}return b.enabledPlugin.filename.match(/flashlite/i)?true:false};if(!window.WEB_SOCKET_DISABLE_AUTO_INITIALIZATION){swfobject.addDomLoadEvent(function(){setTimeout(function(){WebSocket.__initialize()},0)})}})();(function(u){var g=u.MutationObserver||u.WebKitMutationObserver||u.MozMutationObserver;if(typeof g!="function"&&typeof g!="object"){return}var a="matchesSelector";if("webkitMatchesSelector" in Element.prototype){a="webkitMatchesSelector"}else{if("mozMatchesSelector" in Element.prototype){a="mozMatchesSelector"}}var p="__mutation_summary_node_map_id__";var m=1;function t(D){if(!D[p]){D[p]=m++;return true}return false}function q(){this.map_={}}q.prototype={set:function(D,E){t(D);this.map_[D[p]]={k:D,v:E}},get:function(E){if(t(E)){return}var D=this.map_[E[p]];if(D){return D.v}},has:function(D){return !t(D)&&D[p] in this.map_},delete_:function(D){if(t(D)){return}delete this.map_[D[p]]},keys:function(){var D=[];for(var E in this.map_){D.push(this.map_[E].k)}return D}};function j(E,D){return Object.prototype.hasOwnProperty.call(E,D)}var f=0;var k=1;var B=2;var n=3;var r=4;var i=5;function w(D){return D==k||D==n}var x=Array.prototype.forEach.call.bind(Array.prototype.forEach);function c(D,F,E){this.rootNode=D;this.elementFilter=F;this.calcReordered=E}c.prototype={getChange:function(D){var E=this.changeMap.get(D);if(!E){E={target:D};this.changeMap.set(D,E)}if(D.nodeType==Node.ELEMENT_NODE){E.matchCaseInsensitive=D instanceof HTMLElement&&D.ownerDocument instanceof HTMLDocument}return E},getParentChange:function(D){var E=this.getChange(D);if(!E.childList){E.childList=true;E.oldParentNode=null}return E},handleChildList:function(D){this.childListChanges=true;x(D.removedNodes,function(E){var F=this.getParentChange(E);if(F.added||F.oldParentNode){F.added=false}else{F.oldParentNode=D.target}},this);x(D.addedNodes,function(E){var F=this.getParentChange(E);F.added=true},this)},handleAttributes:function(E){this.attributesChanges=true;var F=this.getChange(E.target);if(!F.attributes){F.attributes=true;F.attributeOldValues={}}var D=F.attributeOldValues;if(!j(D,E.attributeName)){D[E.attributeName]=E.oldValue}},handleCharacterData:function(D){this.characterDataChanges=true;var E=this.getChange(D.target);if(E.characterData){return}E.characterData=true;E.characterDataOldValue=D.oldValue},processMutations:function(E){this.mutations=E;this.changeMap=new q;this.mutations.forEach(function(N){switch(N.type){case"childList":this.handleChildList(N);break;case"attributes":this.handleAttributes(N);break;case"characterData":this.handleCharacterData(N);break}},this);var H=this.entered=[];var L=this.exited=[];var J=this.stayedIn=new q;if(!this.childListChanges&&!this.attributesChanges){return}var G=this.matchabilityChange.bind(this);var F=this.reachabilityChange.bind(this);var K=this.wasReordered.bind(this);var I=new q;var M=this;function D(Q,O){if(I.has(Q)){return}I.set(Q,true);var S=M.changeMap.get(Q);var P=O;if((S&&S.childList)||P==undefined){P=F(Q)}if(P==f){return}G(Q);if(P==k){H.push(Q)}else{if(P==n){L.push(Q)}else{if(P==B){var N=B;if(S&&S.childList){if(S.oldParentNode!==Q.parentNode){N=r}else{if(M.calcReordered&&K(Q)){N=i}}}J.set(Q,N)}}}if(P==B){return}for(var R=Q.firstChild;R;R=R.nextSibling){D(R,P)}}this.changeMap.keys().forEach(function(N){D(N)})},getChanged:function(E){var D=this.matchabilityChange.bind(this);this.entered.forEach(function(F){var G=D(F);if(G==k||G==B){E.added.push(F)}});this.stayedIn.keys().forEach(function(G){var H=D(G);if(H==k){E.added.push(G)}else{if(H==n){E.removed.push(G)}else{if(H==B&&(E.reparented||E.reordered)){var F=this.stayedIn.get(G);if(E.reparented&&F==r){E.reparented.push(G)}else{if(E.reordered&&F==i){E.reordered.push(G)}}}}}},this);this.exited.forEach(function(F){var G=D(F);if(G==n||G==B){E.removed.push(F)}})},getOldParentNode:function(E){var F=this.changeMap.get(E);if(F&&F.childList){return F.oldParentNode?F.oldParentNode:null}var D=this.reachabilityChange(E);if(D==f||D==k){throw Error("getOldParentNode requested on invalid node.")}return E.parentNode},getOldPreviousSibling:function(D){var E=this.childlistChanges.get(D.parentNode);if(!E||!this.wasReordered(D)){throw Error("getOldPreviousSibling requested on invalid node.")}return E.oldPreviousSibling.get(D)},getOldAttribute:function(E,D){var F=this.changeMap.get(E);if(!F||!F.attributes){throw Error("getOldAttribute requested on invalid node.")}if(F.matchCaseInsensitive){D=D.toLowerCase()}if(!j(F.attributeOldValues,D)){throw Error("getOldAttribute requested for unchanged attribute name.")}return F.attributeOldValues[D]},getAttributesChanged:function(J){if(!this.attributesChanges){return{}}var E;var G;if(J){E={};G={};J.forEach(function(N){E[N]=true;var O=N.toLowerCase();if(N!=O){G[O]=N}})}var M={};var D=this.changeMap.keys();for(var I=0;I<D.length;I++){var F=D[I];var K=this.changeMap.get(F);if(!K.attributes){continue}if(B!=this.reachabilityChange(F)||B!=this.matchabilityChange(F)){continue}var H=F;var L=K.attributeOldValues;Object.keys(L).forEach(function(O){var N=O;if(K.matchCaseInsensitive&&G&&G[O]){N=G[O]}if(E&&!E[N]){return}if(H.getAttribute(O)==L[O]){return}if(!M[N]){M[N]=[]}M[N].push(H)})}return M},getOldCharacterData:function(D){var E=this.changeMap.get(D);if(!E||!E.characterData){throw Error("getOldCharacterData requested on invalid node.")}return E.characterDataOldValue},getCharacterDataChanged:function(){if(!this.characterDataChanges){return[]}var E=this.changeMap.keys();var D=[];for(var F=0;F<E.length;F++){var G=E[F];if(B!=this.reachabilityChange(G)||B!=this.matchabilityChange(G)){continue}var H=this.changeMap.get(G);if(!H.characterData||G.textContent==H.characterDataOldValue){continue}D.push(G)}return D},reachabilityChange:function(G){this.reachableCache=this.reachableCache||new q;this.wasReachableCache=this.wasReachableCache||new q;var E=this.rootNode;var F=this.changeMap;var K=this.reachableCache;var H=this.wasReachableCache;function D(L){var M=F.get(L);if(M&&M.childList){if(M.oldParentNode){return M.oldParentNode}if(M.added){return null}}return L.parentNode}function J(L){if(L===E){return true}if(!L){return false}var M=K.get(L);if(M===undefined){M=J(L.parentNode);K.set(L,M)}return M}function I(L){if(L===E){return true}if(!L){return false}var M=H.get(L);if(M===undefined){M=I(D(L));H.set(L,M)}return M}if(J(G)){return I(G)?B:k}else{return I(G)?n:f}},checkWasMatching:function(G,E,L){var P=this.changeMap.get(G);if(!P||!P.attributeOldValues){return L}var I=E.tagName;if(P.matchCaseInsensitive&&I!="*"&&j(E,"caseInsensitiveTagName")){I=E.caseInsensitiveTagName}if(I!="*"&&I!=G.tagName){return false}var D=P.attributeOldValues;var F=E.qualifiers.some(function(Q){if(Q.klass){return j(D,"class")}else{if(Q.id){return j(D,"id")}else{return P.matchCaseInsensitive&&j(Q,"caseInsensitiveAttrName")?j(D,Q.caseInsensitiveAttrName):j(D,Q.attrName)}}});if(!F){return L}for(var K=0;K<E.qualifiers.length;K++){var N=E.qualifiers[K];var O;if(N.klass){O="class"}else{if(N.id){O="id"}else{if(P.matchCaseInsensitive&&j(N,"caseInsensitiveAttrName")){O=N.caseInsensitiveAttrName}else{O=N.attrName}}}var J=N.klass?true:N.contains;var H=j(D,O)?D[O]:G.getAttribute(O);if(H==null){return false}if(N.hasOwnProperty("attrValue")){if(!J&&N.attrValue!==H){return false}var M=H.split(" ").some(function(Q){return Q==N.attrValue});if(!M){return false}}}return true},matchabilityChange:function(I){if(this.filterCharacterData){switch(I.nodeType){case Node.COMMENT_NODE:case Node.TEXT_NODE:return B;default:return f}}if(!this.elementFilter){return B}if(I.nodeType!==Node.ELEMENT_NODE){return f}var G=I;function H(L){if(!this.matchCache){this.matchCache={}}if(!this.matchCache[L.selectorString]){this.matchCache[L.selectorString]=new q}var K=this.matchCache[L.selectorString];var J=K.get(G);if(J!==undefined){return J}var M=G[a](L.selectorString);var N=this.checkWasMatching(G,L,M);if(M){J=N?B:k}else{J=N?n:f}K.set(G,J);return J}var E=this.elementFilter.map(H,this);var D=f;var F=0;while(D!=B&&F<E.length){switch(E[F]){case B:D=B;break;case k:if(D==n){D=B}else{D=k}break;case n:if(D==k){D=B}else{D=n}break}F++}return D},processChildlistChanges:function(){if(this.childlistChanges){return}var E=this.childlistChanges=new q;function D(G){var H=E.get(G);if(!H){H={added:new q,removed:new q,maybeMoved:new q,oldPrevious:new q};E.set(G,H)}return H}var F=this.reachabilityChange.bind(this);this.mutations.forEach(function(H){if(H.type!="childList"){return}if(F(H.target)!=B){return}var J=D(H.target);var G=H.previousSibling;function I(L,K){if(!L||J.oldPrevious.has(L)||J.added.has(L)||J.maybeMoved.has(L)){return}if(K&&(J.added.has(K)||J.maybeMoved.has(K))){return}J.oldPrevious.set(L,K)}x(H.removedNodes,function(K){I(K,G);if(J.added.has(K)){J.added.delete_(K)}else{J.removed.set(K,true);J.maybeMoved.delete_(K,true)}G=K});I(H.nextSibling,G);x(H.addedNodes,function(K){if(J.removed.has(K)){J.removed.delete_(K);J.maybeMoved.set(K,true)}else{J.added.set(K,true)}})})},wasReordered:function(E){if(!this.childListChanges){return false}this.processChildlistChanges();var I=this.childlistChanges.get(E.parentNode);if(I.moved){return I.moved.get(E)}var J=I.moved=new q;var D=new q;function F(N){while(N=N.previousSibling){if(D.has(N)){return false}}return true}function H(N){if(!N){return false}if(!I.maybeMoved.has(N)){return false}var O=J.get(N);if(O!==undefined){return O}if(D.has(N)){O=F(N)}else{D.set(N,true);O=M(N)!==L(N)}if(D.has(N)){D.delete_(N);J.set(N,O)}else{O=J.get(N)}return O}var K=I.oldPreviousSibling=new q;function L(O){var N=K.get(O);if(N!==undefined){return N}N=I.oldPrevious.get(O);while(N&&(I.removed.has(N)||H(N))){N=L(N)}if(N===undefined){N=O.previousSibling}K.set(O,N);return N}var G=new q;function M(O){if(G.has(O)){return G.get(O)}var N=O.previousSibling;while(N&&(I.added.has(N)||H(N))){N=N.previousSibling}G.set(O,N);return N}I.maybeMoved.keys().forEach(H);return I.moved.get(E)}};var v=/[a-zA-Z_]+/;var A=/[a-zA-Z0-9_\-]+/;function C(P){var M=[];var J;var L;function O(){if(J){if(L){J.qualifiers.push(L);L=undefined}M.push(J)}J={qualifiers:[]}}function N(){if(L){J.qualifiers.push(L)}L={}}var ad=/\s/;var D;var E="Invalid or unsupported selector syntax.";var K=1;var W=2;var Q=3;var X=4;var ab=5;var U=6;var F=7;var Z=8;var G=9;var V=10;var ac=11;var I=12;var T=13;var S=14;var H=K;var Y=0;while(Y<P.length){var aa=P[Y++];switch(H){case K:if(aa.match(v)){O();J.tagName=aa;H=W;break}if(aa=="*"){O();J.tagName="*";H=Q;break}if(aa=="."){O();N();J.tagName="*";L.klass=true;H=X;break}if(aa=="#"){O();N();J.tagName="*";L.id=true;H=X;break}if(aa=="["){O();N();J.tagName="*";L.attrName="";H=U;break}if(aa.match(ad)){break}throw Error(E);case W:if(aa.match(A)){J.tagName+=aa;break}if(aa=="."){N();L.klass=true;H=X;break}if(aa=="#"){N();L.id=true;H=X;break}if(aa=="["){N();L.attrName="";H=U;break}if(aa.match(ad)){H=S;break}if(aa==","){H=K;break}throw Error(E);case Q:if(aa=="."){N();L.klass=true;H=X;break}if(aa=="#"){N();L.id=true;H=X;break}if(aa=="["){N();L.attrName="";H=U;break}if(aa.match(ad)){H=S;break}if(aa==","){H=K;break}throw Error(E);case X:if(aa.match(v)){L.attrValue=aa;H=ab;break}throw Error(E);case ab:if(aa.match(A)){L.attrValue+=aa;break}if(aa=="."){N();L.klass=true;H=X;break}if(aa=="#"){N();L.id=true;H=X;break}if(aa=="["){N();H=U;break}if(aa.match(ad)){H=S;break}if(aa==","){H=K;break}throw Error(E);case U:if(aa.match(v)){L.attrName=aa;H=F;break}if(aa.match(ad)){break}throw Error(E);case F:if(aa.match(A)){L.attrName+=aa;break}if(aa.match(ad)){H=Z;break}if(aa=="~"){L.contains=true;H=G;break}if(aa=="="){L.attrValue="";H=ac;break}if(aa=="]"){H=Q;break}throw Error(E);case Z:if(aa=="~"){L.contains=true;H=G;break}if(aa=="="){L.attrValue="";H=ac;break}if(aa=="]"){H=Q;break}if(aa.match(ad)){break}throw Error(E);case G:if(aa=="="){L.attrValue="";H=ac;break}throw Error(E);case V:if(aa=="]"){H=Q;break}if(aa.match(ad)){break}throw Error(E);case ac:if(aa.match(ad)){break}if(aa=='"'||aa=="'"){D=aa;H=T;break}L.attrValue+=aa;H=I;break;case I:if(aa.match(ad)){H=V;break}if(aa=="]"){H=Q;break}if(aa=="'"||aa=='"'){throw Error(E)}L.attrValue+=aa;break;case T:if(aa==D){H=V;break}L.attrValue+=aa;break;case S:if(aa.match(ad)){break}if(aa==","){H=K;break}throw Error(E)}}switch(H){case K:case W:case Q:case ab:case S:O();break;default:throw Error(E)}if(!M.length){throw Error(E)}function R(ae){return'"'+ae.replace(/"/,'\\"')+'"'}M.forEach(function(ae){var ag=ae.tagName.toUpperCase();if(ae.tagName!=ag){ae.caseInsensitiveTagName=ag}var af=ae.tagName;ae.qualifiers.forEach(function(ah){if(ah.klass){af+="."+ah.attrValue}else{if(ah.id){af+="#"+ah.attrValue}else{var ai=ah.attrName.toLowerCase();if(ah.attrName!=ai){ah.caseInsensitiveAttrName=ai}if(ah.contains){af+="["+ah.attrName+"~="+R(ah.attrValue)+"]"}else{af+="["+ah.attrName;if(ah.hasOwnProperty("attrValue")){af+="="+R(ah.attrValue)}af+="]"}}}});ae.selectorString=af});return M}var e=/^([a-zA-Z:_]+[a-zA-Z0-9_\-:\.]*)$/;function b(D){if(typeof D!="string"){throw Error("Invalid request opion. attribute must be a non-zero length string.")}D=D.trim();if(!D){throw Error("Invalid request opion. attribute must be a non-zero length string.")}if(!D.match(e)){throw Error("Invalid request option. invalid attribute name: "+D)}return D}function h(I){if(!I.trim().length){throw Error("Invalid request option: elementAttributes must contain at least one attribute.")}var H={};var D={};var G=I.split(/\s+/);for(var E=0;E<G.length;E++){var F=G[E];if(!F){continue}var F=b(F);if(H.hasOwnProperty(F.toLowerCase())){throw Error("Invalid request option: observing multiple case varitations of the same attribute is not supported.")}D[F]=true;H[F.toLowerCase()]=true}return Object.keys(D)}function d(D){var K={callback:true,queries:true,rootNode:true,observeOwnChanges:true};var I={};for(var F in D){if(!(F in K)){throw Error("Invalid option: "+F)}}if(typeof D.callback!=="function"){throw Error("Invalid options: callback is required and must be a function")}I.callback=D.callback;I.rootNode=D.rootNode||document;I.observeOwnChanges=D.observeOwnChanges;if(!D.queries||!D.queries.length){throw Error("Invalid options: queries must contain at least one query request object.")}I.queries=[];for(var E=0;E<D.queries.length;E++){var H=D.queries[E];if(H.all){if(Object.keys(H).length>1){throw Error("Invalid request option. all has no options.")}I.queries.push({all:true});continue}if(H.hasOwnProperty("attribute")){var J={attribute:b(H.attribute)};J.elementFilter=C("*["+J.attribute+"]");if(Object.keys(H).length>1){throw Error("Invalid request option. attribute has no options.")}I.queries.push(J);continue}if(H.hasOwnProperty("element")){var G=Object.keys(H).length;var J={element:H.element,elementFilter:C(H.element)};if(H.hasOwnProperty("elementAttributes")){J.elementAttributes=h(H.elementAttributes);G--}if(G>1){throw Error("Invalid request option. element only allows elementAttributes option.")}I.queries.push(J);continue}if(H.characterData){if(Object.keys(H).length>1){throw Error("Invalid request option. characterData has no options.")}I.queries.push({characterData:true});continue}throw Error("Invalid request option. Unknown query request.")}return I}function o(E){var D={};E.forEach(function(F){F.qualifiers.forEach(function(G){if(G.klass){D["class"]=true}else{if(G.id){D.id=true}else{D[G.attrName]=true}}})});return Object.keys(D)}function s(E){var G={childList:true,subtree:true};var D;function F(H){if(G.attributes&&!D){return}G.attributes=true;G.attributeOldValue=true;if(!H){D=undefined;return}D=D||{};H.forEach(function(I){D[I]=true;D[I.toLowerCase()]=true})}E.forEach(function(I){if(I.characterData){G.characterData=true;G.characterDataOldValue=true;return}if(I.all){F();G.characterData=true;G.characterDataOldValue=true;return}if(I.attribute){F([I.attribute.trim()]);return}if(I.elementFilter&&I.elementFilter.some(function(J){return J.className})){F(["class"])}var H=o(I.elementFilter).concat(I.elementAttributes||[]);if(H.length){F(H)}});if(D){G.attributeFilter=Object.keys(D)}return G}function y(D,E,I){D.elementFilter=I.elementFilter;D.filterCharacterData=I.characterData;var F={target:E,type:"summary",added:[],removed:[]};F.getOldParentNode=D.getOldParentNode.bind(D);if(I.all||I.element){F.reparented=[]}if(I.all){F.reordered=[]}D.getChanged(F);if(I.all||I.attribute||I.elementAttributes){var H=I.attribute?[I.attribute]:I.elementAttributes;var G=D.getAttributesChanged(H);if(I.attribute){F.valueChanged=[];if(G[I.attribute]){F.valueChanged=G[I.attribute]}F.getOldAttribute=function(K){return D.getOldAttribute(K,I.attribute)}}else{F.attributeChanged=G;if(I.elementAttributes){I.elementAttributes.forEach(function(K){if(!F.attributeChanged.hasOwnProperty(K)){F.attributeChanged[K]=[]}})}F.getOldAttribute=D.getOldAttribute.bind(D)}}if(I.all||I.characterData){var J=D.getCharacterDataChanged();F.getOldCharacterData=D.getOldCharacterData.bind(D);if(I.characterData){F.valueChanged=J}else{F.characterDataChanged=J}}if(F.reordered){F.getOldPreviousSibling=D.getOldPreviousSibling.bind(D)}return F}function z(E){var G=false;var Q=d(E);var D=s(Q.queries);var L=Q.rootNode;var N=Q.callback;var M=Array.prototype.concat.apply([],Q.queries.map(function(R){return R.elementFilter?R.elementFilter:[]}));if(!M.length){M=undefined}var O=Q.queries.some(function(R){return R.all});var P=[];if(z.createQueryValidator){P=Q.queries.map(function(R){return z.createQueryValidator(L,R)})}function I(){P.forEach(function(R){if(R){R.recordPreviousState()}})}function H(R){P.forEach(function(T,S){if(T){T.validate(R[S])}})}function F(S){if(!S||!S.length){return[]}var R=new c(L,M,O);R.processMutations(S);return Q.queries.map(function(T){return y(R,L,T)})}function K(R){return R.some(function(S){var U=["added","removed","reordered","reparented","valueChanged","characterDataChanged"];if(U.some(function(V){return S[V]&&S[V].length})){return true}if(S.attributeChanged){var T=Object.keys(S.attributeChanged).some(function(V){return S.attributeChanged[V].length});if(T){return true}}return false})}var J=new g(function(R){if(!Q.observeOwnChanges){J.disconnect()}var S=F(R);H(S);if(Q.observeOwnChanges){I()}if(K(S)){N(S)}if(!Q.observeOwnChanges){I();J.observe(L,D)}});this.reconnect=function(){if(G){throw Error("Already connected")}J.observe(L,D);G=true;I()};this.disconnect=function(){if(!G){throw Error("Not connected")}var R;if(typeof J.takeRecords=="function"){R=J.takeRecords()}else{console.log("Warning: MutationObserver.takeRecords not implemented. Current changes cannot be reported.")}J.disconnect();G=false;var S=F(R);if(K(S)){return S}};this.reconnect()}u.MutationSummary=z;u.MutationSummary.NodeMap=q;u.MutationSummary.parseElementFilter=C})(this);function TreeMirror(a,b){this.root=a;this.idMap={};this.delegate=b}TreeMirror.prototype={initialize:function(a,c){this.idMap[a]=this.root;for(var b=0;b<c.length;b++){this.deserializeNode(c[b],this.root)}},deserializeNode:function(a,c){if(a===null){return null}if(typeof a=="number"){return this.idMap[a]}var e=this.root;var d;switch(a.nodeType){case Node.COMMENT_NODE:d=e.createComment(a.textContent);break;case Node.TEXT_NODE:d=e.createTextNode(a.textContent);break;case Node.DOCUMENT_TYPE_NODE:d=e.implementation.createDocumentType(a.name,a.publicId,a.systemId);break;case Node.ELEMENT_NODE:if(this.delegate&&this.delegate.createElement){d=this.delegate.createElement(a.tagName)}if(!d){d=e.createElement(a.tagName)}Object.keys(a.attributes).forEach(function(f){if(f!="onload"&&f!="onerror"){if(!this.delegate||!this.delegate.setAttribute||!this.delegate.setAttribute(d,f,a.attributes[f])){try{d.setAttribute(f,a.attributes[f])}catch(g){}}}},this);break}this.idMap[a.id]=d;if(c){c.appendChild(d)}if(a.childNodes){for(var b=0;b<a.childNodes.length;b++){this.deserializeNode(a.childNodes[b],d)}}return d},applyChanged:function(e,d,a,g){function f(i){if(i.parentNode){i.parentNode.removeChild(i)}}function h(m){var i=m.parentNode;var k=m.previousSibling;var j=m.node;i.insertBefore(j,k?k.nextSibling:i.firstChild)}function c(j){var i=this.deserializeNode(j.node);Object.keys(j.attributes).forEach(function(m){var k=j.attributes[m];if(k===null){i.removeAttribute(m)}else{if(!this.delegate||!this.delegate.setAttribute||!this.delegate.setAttribute(i,m,k)){try{i.setAttribute(m,k)}catch(n){}}}},this)}function b(j){var i=this.deserializeNode(j.node);i.textContent=j.textContent}d.forEach(function(i){i.node=this.deserializeNode(i.node);i.previousSibling=this.deserializeNode(i.previousSibling);i.parentNode=this.deserializeNode(i.parentNode);f(i.node)},this);e.map(this.deserializeNode,this).forEach(f);d.forEach(h);a.forEach(c,this);g.forEach(b,this);e.forEach(function(i){delete this.idMap[i]},this)}};function TreeMirrorClient(g,f,e){this.target=g;this.mirror=f;this.knownNodes=new MutationSummary.NodeMap;var a=this.serializeNode(g).id;var d=[];for(var h=g.firstChild;h;h=h.nextSibling){d.push(this.serializeNode(h,true))}this.mirror.initialize(a,d);var b=this;var c=[{all:true}];if(e){c=c.concat(e)}this.mutationSummary=new MutationSummary({rootNode:g,callback:function(i){b.applyChanged(i)},queries:c})}TreeMirrorClient.prototype={nextId:1,disconnect:function(){if(this.mutationSummary){this.mutationSummary.disconnect();this.mutationSummary=undefined}},rememberNode:function(a){var b=this.nextId++;this.knownNodes.set(a,b);return b},forgetNode:function(a){delete this.knownNodes.delete_(a)},serializeNode:function(d,b){if(d===null){return null}var g=this.knownNodes.get(d);if(g!==undefined){return g}var e={nodeType:d.nodeType,id:this.rememberNode(d)};switch(e.nodeType){case Node.DOCUMENT_TYPE_NODE:e.name=d.name;e.publicId=d.publicId;e.systemId=d.systemId;break;case Node.COMMENT_NODE:case Node.TEXT_NODE:e.textContent=d.textContent;break;case Node.ELEMENT_NODE:e.tagName=d.tagName;e.attributes={};for(var c=0;c<d.attributes.length;c++){var a=d.attributes.item(c);e.attributes[a.name]=a.value}if(b&&d.childNodes.length){e.childNodes=[];for(var f=d.firstChild;f;f=f.nextSibling){e.childNodes.push(this.serializeNode(f,true))}}break}return e},serializeAddedAndMoved:function(d){var b=d.added.concat(d.reparented).concat(d.reordered);var c=new MutationSummary.NodeMap;b.forEach(function(g){var f=g.parentNode;var e=c.get(f);if(!e){e=new MutationSummary.NodeMap;c.set(f,e)}e.set(g,true)});var a=[];c.keys().forEach(function(f){var e=c.get(f);var h=e.keys();while(h.length){var g=h[0];while(g.previousSibling&&e.has(g.previousSibling)){g=g.previousSibling}while(g&&e.has(g)){a.push({node:this.serializeNode(g),previousSibling:this.serializeNode(g.previousSibling),parentNode:this.serializeNode(g.parentNode)});e.delete_(g);g=g.nextSibling}var h=e.keys()}},this);return a},serializeAttributeChanges:function(a){var b=new MutationSummary.NodeMap;Object.keys(a).forEach(function(c){a[c].forEach(function(e){var d=b.get(e);if(!d){d={node:this.serializeNode(e),attributes:{}};b.set(e,d)}d.attributes[c]=e.getAttribute(c)},this)},this);return b.keys().map(function(c){return b.get(c)})},serializeCharacterDataChange:function(a){return{node:this.serializeNode(a),textContent:a.textContent}},applyChanged:function(c){var f=c[0];var d=f.removed.map(this.serializeNode,this);var b=this.serializeAddedAndMoved(f);var a=this.serializeAttributeChanges(f.attributeChanged);var e=f.characterDataChanged.map(this.serializeCharacterDataChange,this);this.mirror.applyChanged(d,b,a,e);f.removed.forEach(this.forgetNode,this)}};var SecondScreenUtils=SecondScreenUtils||{};(function(){var a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var d=new Array(-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-1,-1,-1,-1,-1);function b(m){var g,j,e;var k,h,f;e=m.length;j=0;g="";while(j<e){k=m.charCodeAt(j++)&255;if(j==e){g+=a.charAt(k>>2);g+=a.charAt((k&3)<<4);g+="==";break}h=m.charCodeAt(j++);if(j==e){g+=a.charAt(k>>2);g+=a.charAt(((k&3)<<4)|((h&240)>>4));g+=a.charAt((h&15)<<2);g+="=";break}f=m.charCodeAt(j++);g+=a.charAt(k>>2);g+=a.charAt(((k&3)<<4)|((h&240)>>4));g+=a.charAt(((h&15)<<2)|((f&192)>>6));g+=a.charAt(f&63)}return g}function c(n){var m,k,h,f;var j,e,g;e=n.length;j=0;g="";while(j<e){do{m=d[n.charCodeAt(j++)&255]}while(j<e&&m==-1);if(m==-1){break}do{k=d[n.charCodeAt(j++)&255]}while(j<e&&k==-1);if(k==-1){break}g+=String.fromCharCode((m<<2)|((k&48)>>4));do{h=n.charCodeAt(j++)&255;if(h==61){return g}h=d[h]}while(j<e&&h==-1);if(h==-1){break}g+=String.fromCharCode(((k&15)<<4)|((h&60)>>2));do{f=n.charCodeAt(j++)&255;if(f==61){return g}f=d[f]}while(j<e&&f==-1);if(f==-1){break}g+=String.fromCharCode(((h&3)<<6)|f)}return g}SecondScreenUtils.base64encode=b;SecondScreenUtils.base64decode=c})();var SecondScreenUtils=SecondScreenUtils||{};(function(){function a(c){return c.replace(/\\u/g,"\\\\u").replace(/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,function(d){var f="";for(var e=0;e<d.length;e++){var g=d.charCodeAt(e).toString(16);f+="\\u"+("0000"+g).substr(g.length)}return f})}function b(c){return c.replace(/(.?)\\u([0-9,a-f,A-F]{4})/g,function(e,f,d){if(f!="\\"){return f+String.fromCharCode(parseInt(d,16))}else{return e}}).replace(/\\\\u/g,"\\u")}SecondScreenUtils.unicode_encode=a;SecondScreenUtils.unicode_decode=b})();var SecondScreenUtils=SecondScreenUtils||{};(function(){function a(o,h,j){var e={};var n=(o+"").split("");var k=[];var f;var g=n[0];var c=256;var m=0;var d=setInterval(function(){m++;for(;m<n.length;m++){f=n[m];if(e.hasOwnProperty(g+f)){g+=f}else{k.push(g.length>1?e[g]:g.charCodeAt(0));if(c<=55295){e[g+f]=c;c++}g=f}if(m%100000==0){j(m,n.length);break}}if(m==n.length){clearInterval(d);j(m,n.length);k.push(g.length>1?e[g]:g.charCodeAt(0));for(var i=0;i<k.length;i++){k[i]=String.fromCharCode(k[i])}h(k.join(""))}},50)}function b(n){var d={};var m=(n+"").split("");var f=m[0];var e=f;var j=[f];var c=256;var g;for(var k=1;k<m.length;k++){var h=m[k].charCodeAt(0);if(h<256){g=m[k]}else{g=d[h]?d[h]:(e+f)}j.push(g);f=g.charAt(0);d[c]=e+f;c++;e=g}return j.join("")}SecondScreenUtils.lzw_encode=a;SecondScreenUtils.lzw_decode=b})();(function(){function a(){this.Diff_Timeout=1;this.Diff_EditCost=4;this.Match_Threshold=0.5;this.Match_Distance=1000;this.Patch_DeleteThreshold=0.5;this.Patch_Margin=4;this.Match_MaxBits=32}a.prototype.diff_main=function(i,h,o,n){"undefined"==typeof n&&(n=0>=this.Diff_Timeout?Number.MAX_VALUE:(new Date).getTime()+1000*this.Diff_Timeout);if(null==i||null==h){throw Error("Null input. (diff_main)")}if(i==h){return i?[[0,i]]:[]}"undefined"==typeof o&&(o=!0);var m=o,k=this.diff_commonPrefix(i,h);o=i.substring(0,k);i=i.substring(k);h=h.substring(k);var k=this.diff_commonSuffix(i,h),j=i.substring(i.length-k);i=i.substring(0,i.length-k);h=h.substring(0,h.length-k);i=this.diff_compute_(i,h,m,n);o&&i.unshift([0,o]);j&&i.push([0,j]);this.diff_cleanupMerge(i);return i};a.prototype.diff_compute_=function(i,h,o,n){if(!i){return[[1,h]]}if(!h){return[[-1,i]]}var m=i.length>h.length?i:h,k=i.length>h.length?h:i,j=m.indexOf(k);return -1!=j?(o=[[1,m.substring(0,j)],[0,k],[1,m.substring(j+k.length)]],i.length>h.length&&(o[0][0]=o[2][0]=-1),o):1==k.length?[[-1,i],[1,h]]:(m=this.diff_halfMatch_(i,h))?(k=m[0],i=m[1],j=m[2],h=m[3],m=m[4],k=this.diff_main(k,j,o,n),o=this.diff_main(i,h,o,n),k.concat([[0,m]],o)):o&&100<i.length&&100<h.length?this.diff_lineMode_(i,h,n):this.diff_bisect_(i,h,n)};a.prototype.diff_lineMode_=function(i,h,o){var n=this.diff_linesToChars_(i,h);i=n.chars1;h=n.chars2;n=n.lineArray;i=this.diff_main(i,h,!1,o);this.diff_charsToLines_(i,n);this.diff_cleanupSemantic(i);i.push([0,""]);for(var m=n=h=0,k="",j="";h<i.length;){switch(i[h][0]){case 1:m++;j+=i[h][1];break;case -1:n++;k+=i[h][1];break;case 0:if(1<=n&&1<=m){i.splice(h-n-m,n+m);h=h-n-m;n=this.diff_main(k,j,!1,o);for(m=n.length-1;0<=m;m--){i.splice(h,0,n[m])}h+=n.length}n=m=0;j=k=""}h++}i.pop();return i};a.prototype.diff_bisect_=function(R,Q,P){for(var O=R.length,N=Q.length,M=Math.ceil((O+N)/2),L=M,K=2*M,I=Array(K),J=Array(K),H=0;H<K;H++){I[H]=-1,J[H]=-1}I[L+1]=0;J[L+1]=0;for(var H=O-N,C=0!=H%2,B=0,z=0,D=0,o=0,x=0;x<M&&!((new Date).getTime()>P);x++){for(var E=-x+B;E<=x-z;E+=2){var G=L+E,F;F=E==-x||E!=x&&I[G-1]<I[G+1]?I[G+1]:I[G-1]+1;for(var A=F-E;F<O&&A<N&&R.charAt(F)==Q.charAt(A);){F++,A++}I[G]=F;if(F>O){z+=2}else{if(A>N){B+=2}else{if(C&&(G=L+H-E,0<=G&&G<K&&-1!=J[G])){var y=O-J[G];if(F>=y){return this.diff_bisectSplit_(R,Q,F,A,P)}}}}}for(E=-x+D;E<=x-o;E+=2){G=L+E;y=E==-x||E!=x&&J[G-1]<J[G+1]?J[G+1]:J[G-1]+1;for(F=y-E;y<O&&F<N&&R.charAt(O-y-1)==Q.charAt(N-F-1);){y++,F++}J[G]=y;if(y>O){o+=2}else{if(F>N){D+=2}else{if(!C&&(G=L+H-E,0<=G&&(G<K&&-1!=I[G])&&(F=I[G],A=L+F-G,y=O-y,F>=y))){return this.diff_bisectSplit_(R,Q,F,A,P)}}}}}return[[-1,R],[1,Q]]};a.prototype.diff_bisectSplit_=function(i,h,o,n,m){var k=i.substring(0,o),j=h.substring(0,n);i=i.substring(o);h=h.substring(n);k=this.diff_main(k,j,!1,m);m=this.diff_main(i,h,!1,m);return k.concat(m)};a.prototype.diff_linesToChars_=function(i,h){function o(e){for(var d="",t=0,s=-1,q=n.length;s<e.length-1;){s=e.indexOf("\n",t);-1==s&&(s=e.length-1);var p=e.substring(t,s+1),t=s+1;(m.hasOwnProperty?m.hasOwnProperty(p):void 0!==m[p])?d+=String.fromCharCode(m[p]):(d+=String.fromCharCode(q),m[p]=q,n[q++]=p)}return d}var n=[],m={};n[0]="";var k=o(i),j=o(h);return{chars1:k,chars2:j,lineArray:n}};a.prototype.diff_charsToLines_=function(h,g){for(var m=0;m<h.length;m++){for(var k=h[m][1],j=[],i=0;i<k.length;i++){j[i]=g[k.charCodeAt(i)]}h[m][1]=j.join("")}};a.prototype.diff_commonPrefix=function(h,g){if(!h||!g||h.charAt(0)!=g.charAt(0)){return 0}for(var m=0,k=Math.min(h.length,g.length),j=k,i=0;m<j;){h.substring(i,j)==g.substring(i,j)?i=m=j:k=j,j=Math.floor((k-m)/2+m)}return j};a.prototype.diff_commonSuffix=function(h,g){if(!h||!g||h.charAt(h.length-1)!=g.charAt(g.length-1)){return 0}for(var m=0,k=Math.min(h.length,g.length),j=k,i=0;m<j;){h.substring(h.length-j,h.length-i)==g.substring(g.length-j,g.length-i)?i=m=j:k=j,j=Math.floor((k-m)/2+m)}return j};a.prototype.diff_commonOverlap_=function(h,g){var m=h.length,k=g.length;if(0==m||0==k){return 0}m>k?h=h.substring(m-k):m<k&&(g=g.substring(0,m));m=Math.min(m,k);if(h==g){return m}for(var k=0,j=1;;){var i=h.substring(m-j),i=g.indexOf(i);if(-1==i){return k}j+=i;if(0==i||h.substring(m-j)==g.substring(0,j)){k=j,j++}}};a.prototype.diff_halfMatch_=function(s,r){function q(C,B,A){for(var z=C.substring(A,A+Math.floor(C.length/4)),y=-1,x="",w,v,f,u;-1!=(y=B.indexOf(z,y+1));){var t=n.diff_commonPrefix(C.substring(A),B.substring(y)),D=n.diff_commonSuffix(C.substring(0,A),B.substring(0,y));x.length<D+t&&(x=B.substring(y-D,y)+B.substring(y,y+t),w=C.substring(0,A-D),v=C.substring(A+t),f=B.substring(0,y-D),u=B.substring(y+t))}return 2*x.length>=C.length?[w,v,f,u,x]:null}if(0>=this.Diff_Timeout){return null}var p=s.length>r.length?s:r,o=s.length>r.length?r:s;if(4>p.length||2*o.length<p.length){return null}var n=this,m=q(p,o,Math.ceil(p.length/4)),p=q(p,o,Math.ceil(p.length/2)),k;if(!m&&!p){return null}k=p?m?m[4].length>p[4].length?m:p:p:m;var i;s.length>r.length?(m=k[0],p=k[1],o=k[2],i=k[3]):(o=k[0],i=k[1],m=k[2],p=k[3]);k=k[4];return[m,p,o,i,k]};a.prototype.diff_cleanupSemantic=function(u){for(var t=!1,s=[],r=0,q=null,p=0,o=0,n=0,k=0,m=0;p<u.length;){0==u[p][0]?(s[r++]=p,o=k,n=m,m=k=0,q=u[p][1]):(1==u[p][0]?k+=u[p][1].length:m+=u[p][1].length,q&&(q.length<=Math.max(o,n)&&q.length<=Math.max(k,m))&&(u.splice(s[r-1],0,[-1,q]),u[s[r-1]+1][0]=1,r--,r--,p=0<r?s[r-1]:-1,m=k=n=o=0,q=null,t=!0)),p++}t&&this.diff_cleanupMerge(u);this.diff_cleanupSemanticLossless(u);for(p=1;p<u.length;){if(-1==u[p-1][0]&&1==u[p][0]){t=u[p-1][1];s=u[p][1];r=this.diff_commonOverlap_(t,s);q=this.diff_commonOverlap_(s,t);if(r>=q){if(r>=t.length/2||r>=s.length/2){u.splice(p,0,[0,s.substring(0,r)]),u[p-1][1]=t.substring(0,t.length-r),u[p+1][1]=s.substring(r),p++}}else{if(q>=t.length/2||q>=s.length/2){u.splice(p,0,[0,t.substring(0,q)]),u[p-1][0]=1,u[p-1][1]=s.substring(0,s.length-q),u[p+1][0]=-1,u[p+1][1]=t.substring(q),p++}}p++}p++}};a.prototype.diff_cleanupSemanticLossless=function(w){function v(F,E){if(!F||!E){return 6}var D=F.charAt(F.length-1),C=E.charAt(0),B=D.match(a.nonAlphaNumericRegex_),A=C.match(a.nonAlphaNumericRegex_),z=B&&D.match(a.whitespaceRegex_),y=A&&C.match(a.whitespaceRegex_),D=z&&D.match(a.linebreakRegex_),C=y&&C.match(a.linebreakRegex_),x=D&&F.match(a.blanklineEndRegex_),k=C&&E.match(a.blanklineStartRegex_);return x||k?5:D||C?4:B&&!z&&y?3:z||y?2:B||A?1:0}for(var u=1;u<w.length-1;){if(0==w[u-1][0]&&0==w[u+1][0]){var t=w[u-1][1],s=w[u][1],r=w[u+1][1],q=this.diff_commonSuffix(t,s);if(q){var p=s.substring(s.length-q),t=t.substring(0,t.length-q),s=p+s.substring(0,s.length-q),r=p+r}for(var q=t,p=s,n=r,o=v(t,s)+v(s,r);s.charAt(0)===r.charAt(0);){var t=t+s.charAt(0),s=s.substring(1)+r.charAt(0),r=r.substring(1),m=v(t,s)+v(s,r);m>=o&&(o=m,q=t,p=s,n=r)}w[u-1][1]!=q&&(q?w[u-1][1]=q:(w.splice(u-1,1),u--),w[u][1]=p,n?w[u+1][1]=n:(w.splice(u+1,1),u--))}u++}};a.nonAlphaNumericRegex_=/[^a-zA-Z0-9]/;a.whitespaceRegex_=/\s/;a.linebreakRegex_=/[\r\n]/;a.blanklineEndRegex_=/\n\r?\n$/;a.blanklineStartRegex_=/^\r?\n\r?\n/;a.prototype.diff_cleanupEfficiency=function(u){for(var t=!1,s=[],r=0,q=null,p=0,o=!1,n=!1,k=!1,m=!1;p<u.length;){if(0==u[p][0]){u[p][1].length<this.Diff_EditCost&&(k||m)?(s[r++]=p,o=k,n=m,q=u[p][1]):(r=0,q=null),k=m=!1}else{if(-1==u[p][0]?m=!0:k=!0,q&&(o&&n&&k&&m||q.length<this.Diff_EditCost/2&&3==o+n+k+m)){u.splice(s[r-1],0,[-1,q]),u[s[r-1]+1][0]=1,r--,q=null,o&&n?(k=m=!0,r=0):(r--,p=0<r?s[r-1]:-1,k=m=!1),t=!0}}p++}t&&this.diff_cleanupMerge(u)};a.prototype.diff_cleanupMerge=function(i){i.push([0,""]);for(var h=0,o=0,n=0,m="",k="",j;h<i.length;){switch(i[h][0]){case 1:n++;k+=i[h][1];h++;break;case -1:o++;m+=i[h][1];h++;break;case 0:1<o+n?(0!==o&&0!==n&&(j=this.diff_commonPrefix(k,m),0!==j&&(0<h-o-n&&0==i[h-o-n-1][0]?i[h-o-n-1][1]+=k.substring(0,j):(i.splice(0,0,[0,k.substring(0,j)]),h++),k=k.substring(j),m=m.substring(j)),j=this.diff_commonSuffix(k,m),0!==j&&(i[h][1]=k.substring(k.length-j)+i[h][1],k=k.substring(0,k.length-j),m=m.substring(0,m.length-j))),0===o?i.splice(h-n,o+n,[1,k]):0===n?i.splice(h-o,o+n,[-1,m]):i.splice(h-o-n,o+n,[-1,m],[1,k]),h=h-o-n+(o?1:0)+(n?1:0)+1):0!==h&&0==i[h-1][0]?(i[h-1][1]+=i[h][1],i.splice(h,1)):h++,o=n=0,k=m=""}}""===i[i.length-1][1]&&i.pop();o=!1;for(h=1;h<i.length-1;){0==i[h-1][0]&&0==i[h+1][0]&&(i[h][1].substring(i[h][1].length-i[h-1][1].length)==i[h-1][1]?(i[h][1]=i[h-1][1]+i[h][1].substring(0,i[h][1].length-i[h-1][1].length),i[h+1][1]=i[h-1][1]+i[h+1][1],i.splice(h-1,1),o=!0):i[h][1].substring(0,i[h+1][1].length)==i[h+1][1]&&(i[h-1][1]+=i[h+1][1],i[h][1]=i[h][1].substring(i[h+1][1].length)+i[h+1][1],i.splice(h+1,1),o=!0)),h++}o&&this.diff_cleanupMerge(i)};a.prototype.diff_xIndex=function(i,h){var o=0,n=0,m=0,k=0,j;for(j=0;j<i.length;j++){1!==i[j][0]&&(o+=i[j][1].length);-1!==i[j][0]&&(n+=i[j][1].length);if(o>h){break}m=o;k=n}return i.length!=j&&-1===i[j][0]?k:k+(h-m)};a.prototype.diff_prettyHtml=function(s){for(var r=[],q=/&/g,p=/</g,o=/>/g,n=/\n/g,m=0;m<s.length;m++){var k=s[m][0],i=s[m][1],i=i.replace(q,"&amp;").replace(p,"&lt;").replace(o,"&gt;").replace(n,"&para;<br>");switch(k){case 1:r[m]='<ins style="background:#e6ffe6;">'+i+"</ins>";break;case -1:r[m]='<del style="background:#ffe6e6;">'+i+"</del>";break;case 0:r[m]="<span>"+i+"</span>"}}return r.join("")};a.prototype.diff_text1=function(e){for(var d=[],f=0;f<e.length;f++){1!==e[f][0]&&(d[f]=e[f][1])}return d.join("")};a.prototype.diff_text2=function(e){for(var d=[],f=0;f<e.length;f++){-1!==e[f][0]&&(d[f]=e[f][1])}return d.join("")};a.prototype.diff_levenshtein=function(i){for(var h=0,o=0,n=0,m=0;m<i.length;m++){var k=i[m][0],j=i[m][1];switch(k){case 1:o+=j.length;break;case -1:n+=j.length;break;case 0:h+=Math.max(o,n),n=o=0}}return h+=Math.max(o,n)};a.prototype.diff_toDelta=function(e){for(var d=[],f=0;f<e.length;f++){switch(e[f][0]){case 1:d[f]="+"+encodeURI(e[f][1]);break;case -1:d[f]="-"+e[f][1].length;break;case 0:d[f]="="+e[f][1].length}}return d.join("\t").replace(/%20/g," ")};a.prototype.diff_fromDelta=function(u,t){for(var s=[],r=0,q=0,p=t.split(/\t/g),o=0;o<p.length;o++){var n=p[o].substring(1);switch(p[o].charAt(0)){case"+":try{s[r++]=[1,decodeURI(n)]}catch(k){throw Error("Illegal escape in diff_fromDelta: "+n)}break;case"-":case"=":var m=parseInt(n,10);if(isNaN(m)||0>m){throw Error("Invalid number in diff_fromDelta: "+n)}n=u.substring(q,q+=m);"="==p[o].charAt(0)?s[r++]=[0,n]:s[r++]=[-1,n];break;default:if(p[o]){throw Error("Invalid diff operation in diff_fromDelta: "+p[o])}}}if(q!=u.length){throw Error("Delta length ("+q+") does not equal source text length ("+u.length+").")}return s};a.prototype.match_main=function(e,d,f){if(null==e||null==d||null==f){throw Error("Null input. (match_main)")}f=Math.max(0,Math.min(f,e.length));return e==d?0:e.length?e.substring(f,f+d.length)==d?f:this.match_bitap_(e,d,f):-1};a.prototype.match_bitap_=function(E,D,C){function B(b,h){var f=b/D.length,c=Math.abs(C-h);return !z.Match_Distance?c?1:f:f+c/z.Match_Distance}if(D.length>this.Match_MaxBits){throw Error("Pattern too long for this browser.")}var A=this.match_alphabet_(D),z=this,y=this.Match_Threshold,x=E.indexOf(D,C);-1!=x&&(y=Math.min(B(0,x),y),x=E.lastIndexOf(D,C+D.length),-1!=x&&(y=Math.min(B(0,x),y)));for(var u=1<<D.length-1,x=-1,v,s,n=D.length+E.length,m,G=0;G<D.length;G++){v=0;for(s=n;v<s;){B(G,C+s)<=y?v=s:n=s,s=Math.floor((n-v)/2+v)}n=s;v=Math.max(1,C-s+1);var o=Math.min(C+s,E.length)+D.length;s=Array(o+2);for(s[o+1]=(1<<G)-1;o>=v;o--){var F=A[E.charAt(o-1)];s[o]=0===G?(s[o+1]<<1|1)&F:(s[o+1]<<1|1)&F|((m[o+1]|m[o])<<1|1)|m[o+1];if(s[o]&u&&(F=B(G,o-1),F<=y)){if(y=F,x=o-1,x>C){v=Math.max(1,2*C-x)}else{break}}}if(B(G+1,C)>y){break}m=s}return x};a.prototype.match_alphabet_=function(e){for(var d={},f=0;f<e.length;f++){d[e.charAt(f)]=0}for(f=0;f<e.length;f++){d[e.charAt(f)]|=1<<e.length-f-1}return d};a.prototype.patch_addContext_=function(f,e){if(0!=e.length){for(var h=e.substring(f.start2,f.start2+f.length1),g=0;e.indexOf(h)!=e.lastIndexOf(h)&&h.length<this.Match_MaxBits-this.Patch_Margin-this.Patch_Margin;){g+=this.Patch_Margin,h=e.substring(f.start2-g,f.start2+f.length1+g)}g+=this.Patch_Margin;(h=e.substring(f.start2-g,f.start2))&&f.diffs.unshift([0,h]);(g=e.substring(f.start2+f.length1,f.start2+f.length1+g))&&f.diffs.push([0,g]);f.start1-=h.length;f.start2-=h.length;f.length1+=h.length+g.length;f.length2+=h.length+g.length}};a.prototype.patch_make=function(w,v,u){var t;if("string"==typeof w&&"string"==typeof v&&"undefined"==typeof u){t=w,v=this.diff_main(t,v,!0),2<v.length&&(this.diff_cleanupSemantic(v),this.diff_cleanupEfficiency(v))}else{if(w&&"object"==typeof w&&"undefined"==typeof v&&"undefined"==typeof u){v=w,t=this.diff_text1(v)}else{if("string"==typeof w&&v&&"object"==typeof v&&"undefined"==typeof u){t=w}else{if("string"==typeof w&&"string"==typeof v&&u&&"object"==typeof u){t=w,v=u}else{throw Error("Unknown call format to patch_make.")}}}}if(0===v.length){return[]}u=[];w=new a.patch_obj;for(var s=0,r=0,q=0,p=t,n=0;n<v.length;n++){var o=v[n][0],m=v[n][1];!s&&0!==o&&(w.start1=r,w.start2=q);switch(o){case 1:w.diffs[s++]=v[n];w.length2+=m.length;t=t.substring(0,q)+m+t.substring(q);break;case -1:w.length1+=m.length;w.diffs[s++]=v[n];t=t.substring(0,q)+t.substring(q+m.length);break;case 0:m.length<=2*this.Patch_Margin&&s&&v.length!=n+1?(w.diffs[s++]=v[n],w.length1+=m.length,w.length2+=m.length):m.length>=2*this.Patch_Margin&&s&&(this.patch_addContext_(w,p),u.push(w),w=new a.patch_obj,s=0,p=t,r=q)}1!==o&&(r+=m.length);-1!==o&&(q+=m.length)}s&&(this.patch_addContext_(w,p),u.push(w));return u};a.prototype.patch_deepCopy=function(h){for(var g=[],m=0;m<h.length;m++){var k=h[m],j=new a.patch_obj;j.diffs=[];for(var i=0;i<k.diffs.length;i++){j.diffs[i]=k.diffs[i].slice()}j.start1=k.start1;j.start2=k.start2;j.length1=k.length1;j.length2=k.length2;g[m]=j}return g};a.prototype.patch_apply=function(y,x){if(0==y.length){return[x,[]]}y=this.patch_deepCopy(y);var w=this.patch_addPadding(y);x=w+x+w;this.patch_splitMax(y);for(var v=0,u=[],t=0;t<y.length;t++){var s=y[t].start2+v,r=this.diff_text1(y[t].diffs),o,p=-1;if(r.length>this.Match_MaxBits){if(o=this.match_main(x,r.substring(0,this.Match_MaxBits),s),-1!=o&&(p=this.match_main(x,r.substring(r.length-this.Match_MaxBits),s+r.length-this.Match_MaxBits),-1==p||o>=p)){o=-1}}else{o=this.match_main(x,r,s)}if(-1==o){u[t]=!1,v-=y[t].length2-y[t].length1}else{if(u[t]=!0,v=o-s,s=-1==p?x.substring(o,o+r.length):x.substring(o,p+this.Match_MaxBits),r==s){x=x.substring(0,o)+this.diff_text2(y[t].diffs)+x.substring(o+r.length)}else{if(s=this.diff_main(r,s,!1),r.length>this.Match_MaxBits&&this.diff_levenshtein(s)/r.length>this.Patch_DeleteThreshold){u[t]=!1}else{this.diff_cleanupSemanticLossless(s);for(var r=0,n,p=0;p<y[t].diffs.length;p++){var m=y[t].diffs[p];0!==m[0]&&(n=this.diff_xIndex(s,r));1===m[0]?x=x.substring(0,o+n)+m[1]+x.substring(o+n):-1===m[0]&&(x=x.substring(0,o+n)+x.substring(o+this.diff_xIndex(s,r+m[1].length)));-1!==m[0]&&(r+=m[1].length)}}}}}x=x.substring(w.length,x.length-w.length);return[x,u]};a.prototype.patch_addPadding=function(h){for(var g=this.Patch_Margin,m="",k=1;k<=g;k++){m+=String.fromCharCode(k)}for(k=0;k<h.length;k++){h[k].start1+=g,h[k].start2+=g}var k=h[0],j=k.diffs;if(0==j.length||0!=j[0][0]){j.unshift([0,m]),k.start1-=g,k.start2-=g,k.length1+=g,k.length2+=g}else{if(g>j[0][1].length){var i=g-j[0][1].length;j[0][1]=m.substring(j[0][1].length)+j[0][1];k.start1-=i;k.start2-=i;k.length1+=i;k.length2+=i}}k=h[h.length-1];j=k.diffs;0==j.length||0!=j[j.length-1][0]?(j.push([0,m]),k.length1+=g,k.length2+=g):g>j[j.length-1][1].length&&(i=g-j[j.length-1][1].length,j[j.length-1][1]+=m.substring(0,i),k.length1+=i,k.length2+=i);return m};a.prototype.patch_splitMax=function(u){for(var t=this.Match_MaxBits,s=0;s<u.length;s++){if(!(u[s].length1<=t)){var r=u[s];u.splice(s--,1);for(var q=r.start1,p=r.start2,o="";0!==r.diffs.length;){var n=new a.patch_obj,k=!0;n.start1=q-o.length;n.start2=p-o.length;""!==o&&(n.length1=n.length2=o.length,n.diffs.push([0,o]));for(;0!==r.diffs.length&&n.length1<t-this.Patch_Margin;){var o=r.diffs[0][0],m=r.diffs[0][1];1===o?(n.length2+=m.length,p+=m.length,n.diffs.push(r.diffs.shift()),k=!1):-1===o&&1==n.diffs.length&&0==n.diffs[0][0]&&m.length>2*t?(n.length1+=m.length,q+=m.length,k=!1,n.diffs.push([o,m]),r.diffs.shift()):(m=m.substring(0,t-n.length1-this.Patch_Margin),n.length1+=m.length,q+=m.length,0===o?(n.length2+=m.length,p+=m.length):k=!1,n.diffs.push([o,m]),m==r.diffs[0][1]?r.diffs.shift():r.diffs[0][1]=r.diffs[0][1].substring(m.length))}o=this.diff_text2(n.diffs);o=o.substring(o.length-this.Patch_Margin);m=this.diff_text1(r.diffs).substring(0,this.Patch_Margin);""!==m&&(n.length1+=m.length,n.length2+=m.length,0!==n.diffs.length&&0===n.diffs[n.diffs.length-1][0]?n.diffs[n.diffs.length-1][1]+=m:n.diffs.push([0,m]));k||u.splice(++s,0,n)}}}};a.prototype.patch_toText=function(e){for(var d=[],f=0;f<e.length;f++){d[f]=e[f]}return d.join("")};a.prototype.patch_fromText=function(j){var i=[];if(!j){return i}j=j.split("\n");for(var q=0,p=/^@@ -(\d+),?(\d*) \+(\d+),?(\d*) @@$/;q<j.length;){var o=j[q].match(p);if(!o){throw Error("Invalid patch string: "+j[q])}var n=new a.patch_obj;i.push(n);n.start1=parseInt(o[1],10);""===o[2]?(n.start1--,n.length1=1):"0"==o[2]?n.length1=0:(n.start1--,n.length1=parseInt(o[2],10));n.start2=parseInt(o[3],10);""===o[4]?(n.start2--,n.length2=1):"0"==o[4]?n.length2=0:(n.start2--,n.length2=parseInt(o[4],10));for(q++;q<j.length;){o=j[q].charAt(0);try{var m=decodeURI(j[q].substring(1))}catch(k){throw Error("Illegal escape in patch_fromText: "+m)}if("-"==o){n.diffs.push([-1,m])}else{if("+"==o){n.diffs.push([1,m])}else{if(" "==o){n.diffs.push([0,m])}else{if("@"==o){break}else{if(""!==o){throw Error('Invalid patch mode "'+o+'" in: '+m)}}}}}q++}}return i};a.patch_obj=function(){this.diffs=[];this.start2=this.start1=null;this.length2=this.length1=0};a.patch_obj.prototype.toString=function(){var e,d;e=0===this.length1?this.start1+",0":1==this.length1?this.start1+1:this.start1+1+","+this.length1;d=0===this.length2?this.start2+",0":1==this.length2?this.start2+1:this.start2+1+","+this.length2;e=["@@ -"+e+" +"+d+" @@\n"];var f;for(d=0;d<this.diffs.length;d++){switch(this.diffs[d][0]){case 1:f="+";break;case -1:f="-";break;case 0:f=" "}e[d+1]=f+encodeURI(this.diffs[d][1])+"\n"}return e.join("").replace(/%20/g," ")};SecondScreenUtils.diff_match_patch=a;SecondScreenUtils.DIFF_DELETE=-1;SecondScreenUtils.DIFF_INSERT=1;SecondScreenUtils.DIFF_EQUAL=0})();var SecondScreenUtils=SecondScreenUtils||{};var _taq=_taq||{};(function(){var a=function(b){this.serverUrl=b;this.server=false;this.serverFrame=false;this._id=0;this.callbacks=[];this.queue=[];this.init()};a.prototype={constructor:a,init:function(){if(this.server||this.serverFrame){return}this.serverFrame=window.document.createElement("iframe");this.serverFrame.style.position="absolute";this.serverFrame.style.left=this.serverFrame.style.top="-999px";var b=this;if(window.addEventListener){window.addEventListener("message",function(c){b.onMessage(c)},false)}else{window.attachEvent("onmessage",function(c){b.onMessage(c)})}window.document.body.appendChild(this.serverFrame);this.serverFrame.src=this.serverUrl},onMessage:function(c){var b;try{b=JSON.parse(c.data)}catch(c){return}if(b.ready===true){this.server=this.serverFrame.contentWindow;this.processQueue();return}else{if(b.type==="get"){if(typeof this.callbacks[b._xds]!=="undefined"){this.callbacks[b._xds](b.val,b)}}else{if(b.type==="allget"){if(typeof this.callbacks[b._xds]!=="undefined"){this.callbacks[b._xds](b.dict,b)}}else{if(b.type==="prefixget"){if(typeof this.callbacks[b._xds]!=="undefined"){this.callbacks[b._xds](b.dict,b)}}else{if(b.type==="set"){if(typeof this.callbacks[b._xds]!=="undefined"){this.callbacks[b._xds](b)}}else{if(b.type==="del"){if(typeof this.callbacks[b._xds]!=="undefined"){this.callbacks[b._xds](b)}}}}}}}},processQueue:function(){if(!this.queue){return}if(!this.server){this.init();return}while(this.queue.length>0){this.server.postMessage(JSON.stringify(this.queue.shift()),"*")}},post:function(b,c){this._id++;b._xds=this._id;if(typeof c!=="undefined"&&c!==null&&c!==false){this.callbacks[this._id]=c}if(this.server){this.server.postMessage(JSON.stringify(b),"*")}else{this.queue.push(b);this.init()}},getSSAllItems:function(b){this.post({type:"allget",store:"ss"},b)},getSSPrefixItems:function(b,c){this.post({type:"prefixget",prefix:b,store:"ss"},c)},getSSItem:function(b,c){this.post({type:"get",key:b,store:"ss"},c)},setSSItem:function(b,c,d){this.post({type:"set",key:b,val:c,store:"ss"},d)},removeSSItem:function(b,c){this.post({type:"del",key:b,store:"ss"},c)},getLSAllItems:function(b){this.post({type:"allget",store:"ls"},b)},getLSPrefixItems:function(b,c){this.post({type:"prefixget",prefix:b,store:"ls"},c)},getLSItem:function(b,c){this.post({type:"get",key:b,store:"ls"},c)},setLSItem:function(b,c,d){this.post({type:"set",key:b,val:c,store:"ls"},d)},removeLSItem:function(b,c){this.post({type:"del",key:b,store:"ls"},c)}};SecondScreenUtils.xds=a;_taq.libs=_taq.libs||{};_taq.libs.xds=a})();function SecondScreen(N,t,s,A,F,Q,M,c){var E=SecondScreenUtils.$;var a="\u0002";var m=1;var u=2;var P=3;var C=5;var U=8;var e=10;var h=12;var Z=15;var X=17;var K=18;var G=19;var D=20;var k=21;var o=31;var z=32;var f=33;var W=34;var J=39;var j=48;var v=101;var T=102;var O=103;var q=115;var d=116;var g=75;var L=76;var B=77;var b=78;var I=79;var x=80;var w=81;var V=82;var r=83;var aa=84;var R=85;var H=86;var Y=87;var n=this;n.user_data={};n.user_data.comp_id=t;n.user_data.cookie_id=N;n.user_data.heads="[]";n.already_joined=false;n.last_connect_successful=false;n.chat_hist_recvd=false;n.pending_proactive_chats=[];n.active=false;n.inactive_timeout=null;n.idle_timeout=null;n.agent_present=null;n.new_tab=false;n.new_sess=c;n.sess_data=A;n.sess_conf=s;var p=s.bk;n.agent_id=null;n._onconnect=[];n._onchatstart=[];n.last_sent=0;n.last_chat_recv_at=null;n.last_chat_agent="Agent";n.unread_chat_count=0;n.unread_chat_show_interval=null;n.unread_chat_show_helper=0;n.pending_move_timeout=null;n.pushed_evs=F;n.pushed_handlers=Q;n.pushed_alarms=M;n.support_agent_name=null;n.cur_page_triggers=null;n.online_depts={};n.mobile=false;if(navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i)){E.each(E('meta[name="viewport"]'),function(i,ac){var ab=E(ac).attr("content");if(ab.indexOf("user-scalable=0")!=-1||ab.indexOf("user-scalable=no")!=-1||ab.indexOf("user-scalable = 0")!=-1||ab.indexOf("user-scalable = no")!=-1){n.mobile=true}})}n.url_regex=/(https?:\/\/)?([a-z0-9\-]+\.)+([0-9]{1,3}|[a-z]{2}|biz|com|edu|gov|info|name|net|org)(:[0-9]+)?(\/\S*)?(?=\s+|$)/gi;for(var S=0;S<n.pushed_handlers.length;S++){if(n.pushed_handlers[S][0]=="connect"){n._onconnect.push(n.pushed_handlers[S][1])}else{if(n.pushed_handlers[S][0]=="chat_start"){n._onchatstart.push(n.pushed_handlers[S][1])}}}n.pushed_handlers=[];var y=SecondScreen._read_sess_data("__ss_vid");if(!n.new_sess&&!y){n.new_tab=true}if(!y){y=N+"-"+new Date().getTime()+"-"+parseInt(Math.random()*10000);SecondScreen._write_sess_data("__ss_vid",y);SecondScreen._write_sess_data("__ss_landtime",new Date().getTime())}n.user_data.visitor_id=y;E(document).ready(function(){SecondScreen._opf=new Date().getTime();SecondScreen._iopf=new Date().getTime();E(document).on("mousedown.__ss_ec keydown.__ss_ec",function(){SecondScreen._iopf=new Date().getTime()});SecondScreen._osf=SecondScreen._read_sess_data("__ss_landtime")});n.flick_title_interval=null;n.chat_enabled=true;n.chat_enabled_by_agent=false;n.prechat_enabled=false;n.offline_message_disabled=false;n.unavail_greet_enabled=false;if(_ss_track.options.chat_no_min){SecondScreen._write_sess_data("__ss_chat","1")}if(typeof _ss_track.options.chat_show!="undefined"&&_ss_track.options.chat_show==false){n.chat_enabled=false}if(typeof _ss_track.options.disable_chat!="undefined"&&_ss_track.options.disable_chat==true){n.chat_enabled=false}if(typeof _ss_track.options.enable_prechat!="undefined"&&_ss_track.options.enable_prechat==true){if(SecondScreen._read_sess_data("__ss_prechat")==null){n.prechat_enabled=true}}if(typeof _ss_track.options.disable_offline_message!="undefined"&&_ss_track.options.disable_offline_message==true){n.offline_message_disabled=true;if(typeof _ss_track.options.enable_unavail_greet!="undefined"&&_ss_track.options.enable_unavail_greet==true){n.unavail_greet_enabled=true}}if(typeof _ss_track.options.enable_chat_by_agent!="undefined"&&_ss_track.options.enable_chat_by_agent==true){n.chat_enabled_by_agent=true;if(SecondScreen._read_sess_data("__ss_chat")!==null){n.chat_enabled=true}}if("https:"==window.location.protocol){n.ws=new WebSocket("wss://"+p.split(":")[0]+"/")}else{if(p.split(":")[1]=="443"){n.ws=new WebSocket("wss://"+p.split(":")[0]+"/")}else{n.ws=new WebSocket("ws://"+p+"/")}}n.ws.onopen=function(){E(window).on("beforeunload",function(){n.last_connect_successful=false;n.hide_chat_widget();n.ws.close()});n.last_connect_successful=true;if(n.already_joined){n.ws.send(String.fromCharCode(m)+n.user_data.visitor_id+a+n.user_data.comp_id+a+n.user_data.heads+a+n.user_data.cookie_id);n.chat_frame.find(".gmg_chat_content .gmg_chat_all div:not(:first-child)").remove();return}n.already_joined=true;if(n.chat_enabled){n.add_chat_widget();if(n.prechat_enabled){n.chat_frame.find(".gmg_chat_online").hide();n.chat_frame.find(".gmg_prechat_online").show()}if(n.offline_message_disabled&&!n.unavail_greet_enabled){n.hide_chat_widget()}}n.ws.send(String.fromCharCode(m)+n.user_data.visitor_id+a+n.user_data.comp_id+a+n.user_data.heads+a+n.user_data.cookie_id);if(n.new_sess||n.new_tab){var af={};E.extend(af,A);var ac=_ss_track.options.vdataprops;for(var ad=0;ad<ac.length;ad++){var ag;try{ag=new Function("return ("+ac[ad][1]+")();")()}catch(ae){ag="(error)"}af[ac[ad][0]]=ag}if(n.new_sess){n.push_event(["started session",af,1])}else{if(n.new_tab){n.push_event(["started session",af,-1])}}}n.push_event(["visited page",{title:document.title,url:location.href.replace(/^.*\/\/[^\/]+/,"")}]);for(var ad=0;ad<n.pushed_evs.length;ad++){n.push_event(n.pushed_evs[ad])}n.pushed_evs=[];for(var ad=0;ad<n._onconnect.length;ad++){(function(){var i=ad;setTimeout(function(){n._onconnect[i](n.new_sess)},0)})()}for(var ad=0;ad<n.pushed_alarms.length;ad++){n.push_alarm(n.pushed_alarms[ad])}n.pushed_alarms=[];n.in_mirror=SecondScreen._read_sess_data("__ss_m");if(n.in_mirror){n.start_mirror()}var ab=function(){var i=new Date().getTime();if(i-n.active>=30000){n.ws.send(String.fromCharCode(D));n.active=false;n.idle_timeout=setTimeout(function(){n.ws.send(String.fromCharCode(k))},180000)}else{setTimeout(ab,30000-(i-n.active))}};E(document).mousemove(function(){if(!n.active){n.ws.send(String.fromCharCode(G));clearTimeout(n.idle_timeout);setTimeout(ab,30000)}n.active=new Date().getTime()});if(typeof s.triggers!="undefined"){n._process_triggers(JSON.parse(s.triggers))}};n.ws.onmessage=function(ah){var ac=ah.data.charCodeAt(0);if(ac==e&&!n.in_mirror){n.start_mirror()}else{if(ac==g){var am=ah.data.substr(1);if(am.length!=0){var ar=n.chat_frame.find(".gmg_chat_all");var ae=n.chat_frame.find(".gmg_chat_wrap");var aq=n.chat_frame.find(".gmg_chat_content");var av=0;var ai=am.split(a);for(var at=0;at<ai.length;at++){if(ai[at].charAt(0)=="0"){var ao=ai[at].lastIndexOf("|");n.add_chat_message("You",ai[at].substring(1,ao))}else{if(ai[at].charAt(0)=="9"){if(ai[at].charAt(1)=="-"){n.add_info_message("Chat has ended. <a href='javascript:void(0)' onclick='window.open(\"//"+_ss_track.GMG_SERVER+"/chemail/"+_ss_track.id+"/"+ai[at].substr(2)+"/"+window.location.hostname+'/","","width=400,height=300,menubar=no,location=no,resizable=yes,scrollbars=yes,status=no")\'>Click here</a> to mail yourself this chat transcript.')}else{n.add_info_message("Chat has ended. <a href='javascript:void(0)' onclick='window.open(\"//"+_ss_track.GMG_SERVER+"/vsrvy/"+_ss_track.id+"/"+ai[at].substr(1)+"/"+window.location.hostname+'/","","width=400,height=500,menubar=no,location=no,resizable=yes,scrollbars=yes,status=no")\'>Click here</a> to provide your feedback or mail yourself this chat transcript.')}}else{if(ai[at].charAt(0)=="1"||ai[at].charAt(0)=="2"){var ag=ai[at].substring(1);var ap=ag.indexOf("|");var ao=ag.lastIndexOf("|");if(ai[at].charAt(0)=="2"){av=ar.height()+aq.height()}n.add_chat_message(ag.substring(0,ap),ag.substring((ap+1),ao));n.last_chat_recv_at=ag.substring(ao+1);n.last_chat_agent=ag.substring(0,ap)}}}}if(n.last_chat_recv_at!=null){n.last_chat_recv_at=new Date(n.last_chat_recv_at*1000);n.update_last_chat_recv_at()}if(av>0&&ar.children().length>1){ae.css("min-height",av+"px")}aq.stop().scrollTop(aq[0].scrollHeight)}if(SecondScreen._read_sess_data("__ss_chat")==="1"){n.chat_show()}if(n.pending_proactive_chats.length>0){if(!n.chat_enabled){return}var ar=n.chat_frame.find(".gmg_chat_all");var ae=n.chat_frame.find(".gmg_chat_wrap");var aq=n.chat_frame.find(".gmg_chat_content");var av=0;for(var at=0;at<n.pending_proactive_chats.length;at++){av=ar.height()+aq.height();n.add_chat_message(n.pending_proactive_chats[at][0],n.pending_proactive_chats[at][1])}if(av>0&&ar.children().length>1){ae.css("min-height",av+"px")}n.pending_proactive_chats=[];n.chat_show()}n.chat_hist_recvd=true}else{if(ac==I){if(SecondScreen._read_sess_data("__ss_chat")==="0"||SecondScreen._read_sess_data("__ss_chat")===null){n.chat_show()}SecondScreen._write_sess_data("chatafterprochat",1)}else{if(ac==L){if(!n.chat_enabled&&n.chat_enabled_by_agent){n.chat_enabled=true;n.add_chat_widget()}var ag=ah.data.substr(1);var ap=ag.indexOf("|");var ak,an;ak=ag.substring(0,ap);an=ag.substring(ap+1);n.add_chat_message(ak,an);if(SecondScreen._read_sess_data("__ss_chat")===null||SecondScreen._read_sess_data("__ss_chat")==="0"){n.chat_show()}n.last_chat_agent=ak;n.last_chat_recv_at=new Date();n.update_last_chat_recv_at();SecondScreen._write_sess_data("chatafterprochat",1);n.play_and_flick();if(window.AndroidInterface){window.AndroidInterface.notifyChat(ak,an)}}else{if(ac==q){n.in_mirror=false;SecondScreen._write_sess_data("__ss_m",0);E(window).off(".__ss");E(document).off(".__ss");clearTimeout(n.mouse_scroll_intr);if(typeof n.diff_intr!="undefined"){clearTimeout(n.diff_intr)}if(typeof n.mirror_client!="undefined"){n.mirror_client.disconnect()}}else{if(ac==u){n.agent_present=false;n._check_triggers();if(!n.chat_enabled){return}n.stop_flick();if(n.offline_message_disabled&&!n.unavail_greet_enabled){n.hide_chat_widget();return}if(n.prechat_enabled){n.chat_frame.find(".gmg_prechat_online").hide()}else{n.chat_frame.find(".gmg_chat_online").hide()}if(!n.offline_message_disabled){n.chat_frame.find(".gmg_chat_offline").show();n.chat_frame.find(".gmg_chat_head b").html(_ss_track.options.offline_title)}else{n.chat_frame.find(".gmg_chat_unavail").show();n.chat_frame.find(".gmg_chat_head b").html(_ss_track.options.unavail_title)}if(n.chat_shown){E("iframe.gmg_chat").css("height",n.chat_frame.css("height"))}}else{if(ac==K){n.agent_present=true;n._check_triggers();if(!n.chat_enabled){return}if(n.offline_message_disabled&&!n.unavail_greet_enabled){n.show_chat_widget();return}if(n.prechat_enabled){n.chat_frame.find(".gmg_prechat_online").show()}else{n.chat_frame.find(".gmg_chat_online").show()}if(!n.offline_message_disabled){n.chat_frame.find(".gmg_chat_offline").hide()}else{n.chat_frame.find(".gmg_chat_unavail").hide()}if(n.chat_shown){E("iframe.gmg_chat").css("height",n.chat_frame.css("height"))}n.chat_frame.find(".gmg_chat_head b").html(_ss_track.options.online_title)}else{if(ac==w){n.chat_frame.find(".gmg_chat_info").text(n.last_chat_agent+" is typing")}else{if(ac==r){n.update_last_chat_recv_at()}else{if(ac==Z){var ad=ah.data.substr(1).split(",");for(var at=0;at<ad.length;at++){n.online_depts[ad[at]]=true}n.update_online_depts()}else{if(ac==o){var aj=ah.data.substr(1).split(",");for(var at=0;at<aj.length;at++){n.online_depts[aj[at]]=null}n.update_online_depts()}else{if(ac==R){var af=ah.data.substr(1);window.location.href=af}else{if(ac==Y){if(_ss_track.options.img_enable){var au=ah.data.substr(1).split(a);var al=au[0];var ak=au[1];var ab=au[2];n.agent_id=al;E(".gmg_chat").contents().find(".chat_agent_img_ico").attr("src",location.protocol+"//"+_ss_track.FE_SERVER+"/agent_img/"+al+"/");n.chat_frame.find(".gmg_agent_name").text(ak||"Agent");n.chat_frame.find(".gmg_agent_name").attr("title",ak||"Agent");n.chat_frame.find(".gmg_agent_img").css("background-image","url("+location.protocol+"//"+_ss_track.FE_SERVER+"/agent_img/"+al+"/)");n.chat_frame.find(".gmg_agent_des").text(ab);n.chat_frame.find(".gmg_agent_des").attr("title",ab);n.chat_frame.find(".gmg_agent_info").show();E("iframe.gmg_chat").css("height",n.chat_frame.css("height"))}}else{if(ac==X){for(var at=0;at<n._onchatstart.length;at++){(function(){var i=at;setTimeout(function(){n._onchatstart[i]()},0)})()}SecondScreen._write_sess_data("__ss_support",1);if(_ss_track.options.img_enable){var au=ah.data.substr(1).split(a);var al=au[0];var ak=au[1];var ab=au[2];n.last_chat_agent=ak;n.agent_id=al;E(".gmg_chat").contents().find(".chat_agent_img_ico").attr("src",location.protocol+"//"+_ss_track.FE_SERVER+"/agent_img/"+al+"/");n.chat_frame.find(".gmg_agent_name").text(ak||"Agent");n.chat_frame.find(".gmg_agent_name").attr("title",ak||"Agent");n.chat_frame.find(".gmg_agent_img").css("background-image","url("+location.protocol+"//"+_ss_track.FE_SERVER+"/agent_img/"+al+"/)");n.chat_frame.find(".gmg_agent_des").text(ab);n.chat_frame.find(".gmg_agent_des").attr("title",ab);n.chat_frame.find(".gmg_agent_info").show();E("iframe.gmg_chat").css("height",n.chat_frame.css("height"))}}else{if(ac==b){SecondScreen._write_sess_data("__ss_support",0)}else{if(ac==H){if(ah.data.charAt(1)=="-"){n.add_info_message("Chat has ended. <a href='javascript:void(0)' onclick='window.open(\"//"+_ss_track.GMG_SERVER+"/chemail/"+_ss_track.id+"/"+ah.data.substr(2)+"/"+window.location.hostname+'/","","width=400,height=300,menubar=no,location=no,resizable=yes,scrollbars=yes,status=no")\'>Click here</a> to mail yourself this chat transcript.')}else{n.add_info_message("Chat has ended. <a href='javascript:void(0)' onclick='window.open(\"//"+_ss_track.GMG_SERVER+"/vsrvy/"+_ss_track.id+"/"+ah.data.substr(1)+"/"+window.location.hostname+'/","","width=400,height=500,menubar=no,location=no,resizable=yes,scrollbars=yes,status=no")\'>Click here</a> to provide your feedback or mail yourself this chat transcript.')}}else{if(ac==J){n.add_info_message("All our agents are currently busy. Please wait and one of our agents will attend to you right away.")}}}}}}}}}}}}}}}}}};n.ws.onclose=function(){if(n.last_connect_successful){if(n.chat_frame){n.add_info_message("Chat is disconnected. Reconnecting now, please wait...");n.chat_frame.find(".gmg_chat_head b").html("Reconnecting, please wait...")}var ac=n.ws.onopen;var ad=n.ws.onmessage;var i=n.ws.onclose;n.last_connect_successful=false;try{if("https:"==window.location.protocol){n.ws=new WebSocket("wss://"+p.split(":")[0]+"/")}else{n.ws=new WebSocket("ws://"+p+"/")}}catch(ab){console.log("caught")}n.ws.onopen=ac;n.ws.onmessage=ad;n.ws.onclose=i}else{n.agent_present=false;if(!n.chat_enabled){return}n.stop_flick();if(n.offline_message_disabled&&!n.unavail_greet_enabled){n.hide_chat_widget();return}if(n.prechat_enabled){n.chat_frame.find(".gmg_prechat_online").hide()}else{n.chat_frame.find(".gmg_chat_online").hide()}if(!n.offline_message_disabled){n.chat_frame.find(".gmg_chat_offline").show();n.chat_frame.find(".gmg_chat_head b").html(_ss_track.options.offline_title)}else{n.chat_frame.find(".gmg_chat_unavail").show();n.chat_frame.find(".gmg_chat_head b").html(_ss_track.options.unavail_title)}if(n.chat_shown){E("iframe.gmg_chat").css("height",n.chat_frame.css("height"))}}}}SecondScreen.prototype.update_online_depts=function(){var c=SecondScreenUtils.$;var b=this;if(!b.chat_enabled){return}var a=b.chat_frame.find(".gmg_route");c(a).each(function(){var e=c(this);var f=e.text();if(b.online_depts[e.attr("data-route")]){e.removeAttr("disabled");var d=f.indexOf(" (not available)");if(d!=-1){e.text(f.substr(0,d))}}else{e.attr("disabled","disabled");var d=f.indexOf(" (not available)");if(d==-1){e.text(f+" (not available)")}}});c(a).parent().each(function(){if(c(this).find("option:checked").is(":disabled")&&c(this).find("option:checked").val()!=""){c(this).val(c(this).find("option:enabled").val());c(this).trigger("change")}})};SecondScreen.prototype.play_and_flick=function(){var c=SecondScreenUtils.$;var a=this;try{c("div.gmg_chat_outer audio")[0].play()}catch(d){}if(!a.chat_frame.find("textarea.gmg_chat_textarea").is(":focus")){if(!a.flick_title_interval){a.orig_title=document.title;var b=true;a.flick_title_interval=setInterval(function(){if(b){document.title=a.last_chat_agent+" says..."}else{document.title=a.orig_title}b=!b},1000)}}};SecondScreen.prototype.stop_flick=function(){var b=SecondScreenUtils.$;var a=this;if(a.flick_title_interval){clearInterval(a.flick_title_interval);a.flick_title_interval=null;document.title=a.orig_title}};SecondScreen.prototype.update_last_chat_recv_at=function(){var b=SecondScreenUtils.$;var a=this;if(a.last_chat_recv_at){a.chat_frame.find(".gmg_chat_info").html("Last message received at "+a.last_chat_recv_at.toLocaleTimeString())}else{a.chat_frame.find(".gmg_chat_info").html("&nbsp;")}};SecondScreen.prototype.push_event=function(c){var e=SecondScreenUtils.$;if(this.ws.readyState!=WebSocket.OPEN){this.pushed_evs.push(c);return}if(c[2]===undefined){c[2]=2}var d=3;var a="\u0002";this.ws.send(String.fromCharCode(d)+c[0]+a+JSON.stringify(c[1])+a+c[2]);this.push_to_ga(c[0]);var b=SecondScreen._read_sess_data("events");if(!b){b={}}if(typeof b[c[0]]==="undefined"){b[c[0]]=[]}b[c[0]].push([c[1],new Date().getTime()]);SecondScreen._write_sess_data("events",b);this._check_conv(c);this._check_triggers(b)};SecondScreen.prototype._check_conv=function(h){var k=this;var d=48;var i=7;var b=8;var g=SecondScreen._read_sess_data("analytic_conv");if(!g){return}var a=SecondScreen._read_sess_data("analytic_lastest_chat_trigger");var f=g[a];if(a&&f){if(k._check_conv_rule(f,h)){k.ws.send(String.fromCharCode(d)+String.fromCharCode(i)+a);SecondScreen._del_sess_data("analytic_lastest_chat_trigger")}}var e=SecondScreen._read_sess_data("analytic_notifclick")||{};var j=false;for(var c in e){if(e.hasOwnProperty(c)){f=g[c];if(f){if(k._check_conv_rule(f,h)){k.ws.send(String.fromCharCode(d)+String.fromCharCode(b)+c);delete e[c];j=true}}}}if(j){SecondScreen._write_sess_data("analytic_notifclick",e)}};SecondScreen.prototype._check_conv_rule=function(g,a){var c=this;if(g.ct=="page_url"){return c._check_condition(location.href.replace(/^.*\/\/[^\/]+/,""),g.a[0],g.c[0])}else{if(g.ct=="did_event"){var e=g.a[0];var f=g.a[1];var b=g.a[2];if(e==a[0]){if(f){var d=a[1];if(typeof d[f]!="undefined"){if(b){if(c._check_condition(d[f],b,g.c[0])){return true}}else{return true}}}else{return true}}return false}}};SecondScreen.prototype.push_to_ga=function(c){var b=this;var d=SecondScreenUtils.$;if(typeof b.sess_conf.gaid!="undefined"){var a=new Image(1,1);a.src=("https:"==window.location.protocol?"https://ssl":"http://www")+".google-analytics.com/collect?v=1&tid="+encodeURIComponent(b.sess_conf.gaid)+"&cid="+encodeURIComponent(b.user_data.cookie_id)+"&t=event&ec=ssevent&ea="+encodeURIComponent(c)+"&el="+encodeURIComponent(b.user_data.cookie_id)+"&z="+(new Date().getTime())+""+parseInt(Math.random()*10000)}};SecondScreen.prototype.push=SecondScreen.prototype.push_event;SecondScreen.prototype.push_handler=function(b){var a=this;if(b[0]=="connect"){if(a.ws.readyState==WebSocket.OPEN){setTimeout(function(){b[1](a.new_sess)},0)}else{a._onconnect.push(b[1])}}else{if(b[0]=="chat_start"){a._onchatstart.push(b[1])}}};SecondScreen.prototype.push_alarm=function(a){if(this.ws.readyState!=WebSocket.OPEN){this.pushed_alarms.push(a);return}this.agent_alarm(a[0],a[1])};SecondScreen.prototype.agent_alarm=function(f,g,d){var c=this;var e=SecondScreenUtils.$;var b=12;var a="\u0002";if(d){c.ws.send(String.fromCharCode(b)+f+a+g+a+d)}else{c.ws.send(String.fromCharCode(b)+f+a+g)}};SecondScreen.prototype._check_condition=function(d,c,a){var b=function(g){if(typeof g==="number"){return g}g=g.replace(/^[^\d]*/,"").replace(/[^\d]*$/,"").replace(/[^\d\.]/g,"");var h=g.charAt(g.length-3);var f=g.charAt(g.length-2);var e=parseInt(g.replace(/[^\d]/g,""));if(h==","||h=="."){e=e/100}else{if(f==","||f=="."){e=e/10}}return e};return(((a=="equal")&&(d==c))||((a=="notequal")&&(d!=c))||((a=="less")&&(b(d)<b(c)))||((a=="lessequal")&&(b(d)<=b(c)))||((a=="greater")&&(b(d)>b(c)))||((a=="greaterequal")&&(b(d)>=b(c)))||((a=="contains")&&((d+"").indexOf(c+"")!==-1))||((a=="doesnotcontain")&&((d+"").indexOf(c+"")===-1))||((a=="regex")&&((new RegExp(c)).test(d))))};SecondScreen.prototype._check_rule=function(h,d){var q=this;var m=h.r;if(m=="did_event"){var g=h.a[0];var p=h.a[1];var o=h.a[2];if(d[g]){for(var r=0;r<d[g].length;r++){var n=d[g][r][1];if(n>=q.last_event_at){if(p){var s=d[g][r][0];if(typeof s[p]!="undefined"){if(o){if(q._check_condition(s[p],o,h.c[0])){q.last_event_at=n;return true}}else{q.last_event_at=n;return true}}}else{q.last_event_at=n;return true}}}}return false}else{if(m=="did_event_count"){var g=h.a[0];var p=h.a[1];var o=h.a[2];var c=h.a[3];var j=0;var k;if(d[g]){for(var r=0;r<d[g].length;r++){var n=d[g][r][1];if(n>=q.last_event_at){if(p){var s=d[g][r][0];if(typeof s[p]!="undefined"){if(o){if(q._check_condition(s[p],o,h.c[0])){j++;k=n}}else{j++;k=n}}}else{j++;k=n}}}}var t=q._check_condition(j,c,h.c[1]);if(t){q.last_event_at=k}return t}else{if(m=="didnot_event"){return !q._check_rule({r:"did_event",a:h.a,c:h.c},d)}else{if(m=="cookie"){var b=function(i){return(document.cookie.match("(^|; )"+i+"=([^;]*)")||0)[2]};var e=h.a[0];var a=h.a[1];var f=b(e);if(f){if(a){return q._check_condition(f,a,h.c[0])}else{return true}}return false}else{if(m=="page_url"){return q._check_condition(location.href.replace(/^.*\/\/[^\/]+/,""),h.a[0],h.c[0])}else{if(m=="page_domain"){return q._check_condition(location.host,h.a[0],h.c[0])}else{if(m=="page_title"){return q._check_condition(document.title,h.a[0],h.c[0])}else{if(m=="last_page_url"){return d["visited page"].length>=2&&q._check_condition(d["visited page"].slice(-2)[0][0]["url"],h.a[0],h.c[0])}else{if(m=="last_page_title"){return d["visited page"].length>=2&&q._check_condition(d["visited page"].slice(-2)[0][0]["title"],h.a[0],h.c[0])}else{if(m=="page_count"){return q._check_condition(d["visited page"].length,h.a[0],h.c[0])}else{if(m=="time_site"){return true}else{if(m=="time_page"){return true}else{if(m=="idle_page"){return true}else{if(m=="leaving_page"){return true}else{if(m=="prochat_agent"){return !(SecondScreen._read_sess_data("chatafterprochat")===0)}else{if(m=="not_in_chat"){return !SecondScreen._read_sess_data("__ss_support")}else{if(m=="agent_present"){return q.agent_present}else{if(d["started session"]&&d["started session"].length>0){if(m=="location"){return q._check_condition(d["started session"].slice(-1)[0][0]["location"],h.a[0],h.c[0])}else{if(m=="referrer"){return q._check_condition(d["started session"].slice(-1)[0][0]["referrer"],h.a[0],h.c[0])}else{if(m=="ip"){return q._check_condition(d["started session"].slice(-1)[0][0]["IP"],h.a[0],h.c[0])}else{if(m=="os"){return q._check_condition(d["started session"].slice(-1)[0][0]["OS"],h.a[0],h.c[0])}else{if(m=="browser"){return q._check_condition(d["started session"].slice(-1)[0][0]["browser"],h.a[0],h.c[0])}}}}}}else{return false}}}}}}}}}}}}}}}}}}};SecondScreen.prototype._do_task=function(i,b){var q=this;var m=SecondScreenUtils.$;var e=32;var d=80;var j=34;var o=48;var p=2;var n=3;var a=4;var h=b.t;if(h=="message_visitor"){if(q.agent_present){if(!q.chat_enabled&&q.chat_enabled_by_agent){q.chat_enabled=true;q.add_chat_widget()}if(!q.chat_enabled){return}if(!SecondScreen._read_sess_data("__ss_support")){if(b.a.length==3&&b.a[2]!="0"){if(!q.online_depts[b.a[2]]){return}else{q.ws.send(String.fromCharCode(e)+b.a[2])}}q.ws.send(String.fromCharCode(d)+b.a[0]+"|"+b.a[1]);if(q.chat_hist_recvd){var g=q.chat_frame.find(".gmg_chat_all");var k=q.chat_frame.find(".gmg_chat_wrap");var c=q.chat_frame.find(".gmg_chat_content");if(g.children().length>1){k.css("min-height",(g.height()+c.height())+"px")}q.add_chat_message(b.a[0],b.a[1]);q.chat_show();q.last_chat_agent=b.a[0];q.last_chat_recv_at=new Date();q.update_last_chat_recv_at();q.play_and_flick();SecondScreen._write_sess_data("chatafterprochat",0)}else{q.pending_proactive_chats.push([b.a[0],b.a[1]]);SecondScreen._write_sess_data("chatafterprochat",0)}q.ws.send(String.fromCharCode(o)+String.fromCharCode(p)+i);SecondScreen._write_sess_data("analytic_latest_trigger",i)}}}else{if(h=="alert_agent"){if(q.agent_present){if(b.a.length==3&&b.a[2]!="0"){if(!q.online_depts[b.a[2]]){return}q.agent_alarm(b.a[0],b.a[1],b.a[2])}else{q.agent_alarm(b.a[0],b.a[1])}q.ws.send(String.fromCharCode(o)+String.fromCharCode(n)+i);SecondScreen._write_sess_data("analytic_latest_trigger",i)}}else{if(h=="show_visitor"){if(!_ss_track.options.vis_dflt_show){q.ws.send(String.fromCharCode(j)+b.a[0])}}else{if(h=="assign_dept"){SecondScreen._write_sess_data("assign_dept",b.a[0]);if(!q.online_depts[b.a[0]]){return}else{q.ws.send(String.fromCharCode(e)+b.a[0])}}else{if(h=="show_notif"){m.ajax({type:"GET",url:"//"+_ss_track.FE_SERVER+"/notifget/"+q.user_data.comp_id+"/"+b.a[0]+"/",data:{},dataType:"jsonp",jsonpCallback:"_ss_on_notif_get",success:function(r){if(r!=null){SecondScreen._show_notification(r,i);q.ws.send(String.fromCharCode(o)+String.fromCharCode(a)+i)}}})}else{if(h=="http_get"){var f="http://query.yahooapis.com/v1/public/yql?q="+encodeURIComponent('select * from xml where url="'+b.a[0]+'"')+"&format=xml&callback=?";m.getJSON(f,function(r){})}}}}}}};SecondScreen.prototype._do_trigger=function(f,h,g){var d=this;var e=48;var a=1;d.ws.send(String.fromCharCode(e)+String.fromCharCode(a)+f);for(var c=0;c<h.length;c++){d._do_task(f,h[c])}if(g&&g.ct!="no_track"){var b=SecondScreen._read_sess_data("analytic_conv")||{};b[f]=g;SecondScreen._write_sess_data("analytic_conv",b)}};SecondScreen.prototype._check_triggers=function(k){var m=this;var i=SecondScreen._read_sess_data("triggers");if(!m.cur_page_triggers){m.cur_page_triggers=i}var f=m.cur_page_triggers;if(!f||m.agent_present===null){return}if(typeof k=="undefined"){k=SecondScreen._read_sess_data("events")}for(var d in f){if(!f.hasOwnProperty(d)){continue}var b=f[d];var n=true;m.last_event_at=b.base_start||0;for(var a=0;a<b.rl.length;a++){if(!m._check_rule(b.rl[a],k)){n=false;break}}if(n){var e=null;var j=null;var c=null;var h=null;for(var a=0;a<b.rl.length;a++){var g=b.rl[a];if(g.r=="time_site"){e=g.a[0]}else{if(g.r=="time_page"){j=g.a[0]}else{if(g.r=="idle_page"){c=g.a[0]}else{if(g.r=="leaving_page"){h=true}}}}}delete f[d];if(e===null){if(typeof b.mult=="undefined"||!b.mult){delete i[d]}else{i[d]["base_start"]=m.last_event_at+1}}if(e===null&&j===null&&c===null&&h===null){m._do_trigger(d,b.tl,b.cl)}else{if(c!==null){(function(){var t=d;var r=b.tl;var s=b.cl;var p=c;var o=new Date().getTime();var q=function(){var u=new Date().getTime();if(u-SecondScreen._iopf>p*1000){m._do_trigger(t,r,s)}else{setTimeout(q,p*1000-(u-SecondScreen._iopf))}};setTimeout(q,Math.max(0,p*1000-(o-SecondScreen._iopf)))})()}else{if(j!==null){(function(){var t=d;var p=b.tl;var q=b.cl;var r=j;var o=new Date().getTime();var s=function(){var u=new Date().getTime();if(u-SecondScreen._opf>r*1000){m._do_trigger(t,p,q)}else{setTimeout(s,r*1000-(u-SecondScreen._opf))}};setTimeout(s,Math.max(0,r*1000-(o-SecondScreen._opf)))})()}else{if(e!==null){(function(){var t=d;var q=b.tl;var s=b.cl;var p=e;var o=new Date().getTime();var r=function(){var u=new Date().getTime();if(u-SecondScreen._osf>p*1000){m._do_trigger(t,q,s);var v=SecondScreen._read_sess_data("triggers");if(typeof v[t]["mult"]=="undefined"||!v[t]["mult"]){delete v[t];SecondScreen._write_sess_data("triggers",v)}}else{setTimeout(r,p*1000-(u-SecondScreen._osf))}};setTimeout(r,Math.max(0,p*1000-(o-SecondScreen._osf)))})()}else{if(h!==null){(function(){var q=d;var o=b.tl;var p=b.cl;SecondScreenUtils.$("body").on("mouseleave._ss_lit",function(r){if(r.clientY<50){SecondScreenUtils.$("body").off("mouseleave._ss_lit");m._do_trigger(q,o,p)}})})()}}}}}}}SecondScreen._write_sess_data("triggers",i)};SecondScreen.prototype._process_triggers=function(a){var c=SecondScreenUtils.$;var b=this;if(!SecondScreen._read_sess_data("triggers")){SecondScreen._write_sess_data("triggers",a);b._check_triggers()}};SecondScreen.prototype.start_mirror=function(){var e=SecondScreenUtils.$;var i=101;var v=102;var q=103;var p=104;var u=105;var k=106;var j=107;var f=108;var h=109;var b=111;var n=116;var o=117;var m=118;var s=this;SecondScreen._write_sess_data("__ss_m",1);s.in_mirror=true;if(typeof WebKitMutationObserver=="function"||typeof WebKitMutationObserver=="object"||typeof MozMutationObserver=="function"||typeof MutationObserver=="function"){if(e("base").length>0){s.ws.send(String.fromCharCode(i)+e("base").attr("href"))}else{s.ws.send(String.fromCharCode(i)+location.href.match(/^(.*\/)[^\/]*$/)[1])}var d=false;var g=[];s.mirror_client=new TreeMirrorClient(document,{initialize:function(z,A){var B=JSON.stringify([z,A]);SecondScreenUtils.lzw_encode(SecondScreenUtils.unicode_encode(B),function(C){s.ws.send(String.fromCharCode(v)+C);d=true;for(var D=0;D<g.length;D++){s.ws.send(String.fromCharCode(q)+g[D])}g=[]},function(D,C){s.ws.send(String.fromCharCode(m)+D+","+C)})},applyChanged:function(B,A,z,C){if(d){s.ws.send(String.fromCharCode(q)+JSON.stringify([B,A,z,C]))}else{g.push(JSON.stringify([B,A,z,C]))}}})}else{var c=document.documentElement.innerHTML;c=c.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,"");if(c.indexOf("<base")==-1){c=c.replace(/<head([^>]*)>/i,'<head$1><base href="'+location.href.match(/^(.*\/)[^\/]*$/)[1]+'">')}SecondScreenUtils.lzw_encode(SecondScreenUtils.unicode_encode(c),function(z){s.ws.send(String.fromCharCode(v)+String.fromCharCode(3)+z);s.old_html=c;s.diff_intr=setInterval(function(){var C=document.documentElement.innerHTML;C=C.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,"");if(C.indexOf("<base")==-1){C=C.replace(/<head([^>]*)>/i,'<head$1><base href="'+location.href.match(/^(.*\/)[^\/]*$/)[1]+'">')}if(C!=s.old_html){var B=new SecondScreenUtils.diff_match_patch();var D=B.diff_main(s.old_html,C);B.diff_cleanupEfficiency(D);var A=B.patch_toText(B.patch_make(s.old_html,D));s.ws.send(String.fromCharCode(q)+String.fromCharCode(3)+A);s.ws.send(String.fromCharCode(u)+JSON.stringify({x:e(window).scrollLeft(),y:e(window).scrollTop()}));s.old_html=C}},5000)},function(A,z){s.ws.send(String.fromCharCode(m)+A+","+z)})}e(window).on("resize.__ss",function(){s.ws.send(String.fromCharCode(p)+JSON.stringify({h:e(window).height(),w:e(window).width()}))});e(window).resize();var a,y,x=false,t,r,w=false;s.mouse_scroll_intr=setInterval(function(){if(x){s.ws.send(String.fromCharCode(u)+JSON.stringify({x:a,y:y}));x=false}if(w){s.ws.send(String.fromCharCode(k)+JSON.stringify({x:t,y:r}));w=false}},100);e(window).on("scroll.__ss",function(){a=e(window).scrollLeft();y=e(window).scrollTop();x=true});e(window).scroll();e(document).on("mousemove.__ss",function(z){t=z.pageX;r=z.pageY;w=true});e(window).on("click.__ss",function(z){s.ws.send(String.fromCharCode(o)+JSON.stringify({x:z.pageX,y:z.pageY}))});e(document).on("input.__ss propertychange.__ss",'input[type="text"]',function(){var z=e("input").index(this);if(e(this).is(_ss_track.options.mask_fields)){var A=new Array(this.value.length+1).join("x")+" (masked)";s.ws.send(String.fromCharCode(j)+JSON.stringify([z,A]))}else{s.ws.send(String.fromCharCode(j)+JSON.stringify([z,this.value]))}});e(document).on("change.__ss",'input[type="radio"], input[type="checkbox"]',function(){var z=e("input").index(this);s.ws.send(String.fromCharCode(j)+JSON.stringify([z,this.checked]))});e(document).on("input.__ss propertychange.__ss","textarea",function(){var z=e("textarea").index(this);if(e(this).is(_ss_track.options.mask_fields)){var A=new Array(this.value.length+1).join("x")+" (masked)";s.ws.send(String.fromCharCode(f)+JSON.stringify([z,A]))}else{s.ws.send(String.fromCharCode(f)+JSON.stringify([z,this.value]))}});e(document).on("change.__ss","select",function(){var z=e("select").index(this);s.ws.send(String.fromCharCode(h)+JSON.stringify([z,this.selectedIndex]))})};SecondScreen.prototype.add_chat_widget=function(){var w="\u0002";var K=81;var p=82;var d=83;var x=84;var c=33;var I=32;var g=SecondScreenUtils.$;var v=this;var k={normal:{widget_w:"280px",chat_head_fs:"12px",greet_fs:"11px",power_fs:"9px",text_fs:"12px",input_fs:"13px",input_w:"270px",textarea_w:"270px",input_pad_w:"253px",chat_cont_h:"253px",off_msg_h:"107px",pic_h_w:"40px",},large:{widget_w:"280px",chat_head_fs:"12px",greet_fs:"12px",power_fs:"10px",text_fs:"14px",input_fs:"14px",input_w:"440px",textarea_w:"440px",input_pad_w:"423px",chat_cont_h:"360px",off_msg_h:"287px",pic_h_w:"40px",},mobile:{widget_w:"98%",chat_head_fs:"1em",greet_fs:"0.9em",power_fs:"0.7em",text_fs:"1em",input_fs:"1em",input_w:"99%",textarea_w:"100%",input_pad_w:"94%",chat_cont_h:"180px",off_msg_h:"107px",pic_h_w:"2.5em",}};if(v.mobile){g("iframe.gmg_chat").contents().find("html,body").css("width","100%");var C=k.mobile}else{var C=_ss_track.options.chat_size==0?k.normal:k.large}var G="";var f=v.sess_conf.settings.pcs;var o=false;for(var B=0;B<f.length;B++){G+="<div class='gmg_prechat_srvy gmg_inp_div'"+(f[B][5]?" id='pcs_wrap_"+f[B][0]+"' style='display:none'":"")+">";var h="";if(f[B][3]){h=" grq";G+="<span class='error'></span>"}var D=null;if(f[B][2]==0){if(f[B][6]!=""){D=JSON.parse(f[B][6])}G+="<select data-set='"+f[B][6]+"' id='"+f[B][0]+"' class='gmg_select"+h+"'>";G+="<option value='' disabled='disabled' selected='selected'>"+f[B][1]+"</option>";var r=f[B][4].split("\r\n");for(var z=0;z<r.length;z++){var m="";if(D&&D.route&&D.route[r[z]]){m="class='gmg_route' data-route='"+D.route[r[z]]+"' disabled='disabled' ";o=true}var F="";if(D&&D.show&&D.show[r[z]]){F="data-show='"+D.show[r[z]]+"' "}G+="<option "+m+F+"value='"+r[z]+"'>"+r[z]+(m?" (not available)":"")+"</option>"}G+="</select></div>"}else{G+="<input id='"+f[B][0]+"' type='text' class='gmg_input"+h+"' placeholder='"+f[B][1]+"'></div>"}}var e="";if(v.sess_conf.settings.depts.length>0&&!o){e="<div class='gmg_prechat_dept gmg_inp_div'><select class='gmg_select'><option value='' disabled='disabled' selected='selected'>Chat with</option>";var y=v.sess_conf.settings.depts;for(var B=0;B<y.length;B++){e+='<option disabled="disabled" class="gmg_route" data-route="'+y[B][0]+'" value="'+y[B][0]+'">'+y[B][1]+" (not available)</option>"}e+="</select></div>"}var u="";if(!_ss_track.options.chat_no_min&&_ss_track.options.chat_close){u="<div class='gmg_chat_close' style='float:right;padding-right:5px;color:"+_ss_track.options.title_text_color+"'>&#x2715;</div>"}var E="<!DOCTYPE html><html><head><style type='text/css'>* {padding:0;margin:0;}"+(v.mobile?"* {-webkit-text-size-adjust:100%;-ms-text-size-adjust:none;}.gmg_chat_textarea{box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box} body {font-size:16px !important;}":"")+" .gmg_chat_line {margin:3px 0;font-size:"+C.input_fs+";} .gmg_chat_line table {border:0;border-collapse:collapse;} .gmg_chat_line table th {background-color:#ccc;border:1px solid #666;padding:2px;text-align:left;} .gmg_chat_line table td {border:1px solid #666;padding:2px;} .gmg_chat_line ul {padding-left:20px;} .gmg_chat_line ol {padding-left:20px;} .gmg_info_msg {color:#555;background-color:#eee;padding:3px;font-size:"+C.greet_fs+";margin:7px 3px 3px 3px;display:inline-block;} .gmg_inp_div {font-size:"+C.text_fs+";margin:6px 4px;color:#000;} .gmg_input {width:"+C.input_pad_w+";height:23px;padding: 4px 5px 4px 10px;border-radius: 4px;border:1px solid #ccc;font-size:"+C.input_fs+";} .gmg_select {width:"+C.input_w+";padding: 4px 5px 4px 10px;border-radius: 4px;height:30px;border:1px solid #ccc;font-size:"+C.input_fs+";background:#fff;};.error {color:red;font-size:"+C.greet_fs+";display:none;}"+_ss_track.options.chat_css+"</style></head><body style='background-color:transparent;overflow:hidden;font-family:tahoma,arial,sans-serif;font-size:12px'><div style='background-color:#eee;border-bottom:1px solid "+_ss_track.options.title_color+";border-left:1px solid "+_ss_track.options.title_color+";border-right:1px solid "+_ss_track.options.title_color+";'><div class='gmg_chat_head' style='padding:8px 0 8px 10px;background:"+_ss_track.options.title_color+";border:1px solid "+_ss_track.options.title_color+";color:"+_ss_track.options.title_text_color+";cursor:pointer;font-size:"+C.chat_head_fs+"'><span class='chat_head_icon'></span><b>"+_ss_track.options.online_title+"</b>"+u+(_ss_track.options.chat_no_min?"":"<div class='gmg_chat_arrow' style='float:right;padding-right:5px;color:"+_ss_track.options.title_text_color+"'>&#x25B2;</div>")+"</div><div class='gmg_prechat_online' style='display:none'><div style='color:#000;background-color:#fff;padding:4px;font-size:"+C.greet_fs+";'>"+_ss_track.options.pre_greet+"</div><form action='javascript:void(0)' class='gmg_prechat_form'><div class='gmg_prechat_name gmg_inp_div'><input placeholder='Name' type='text' class='gmg_input' value='"+_ss_track.options.visitor_name+"'></div><div class='gmg_prechat_email gmg_inp_div'><span class='error'></span><input placeholder='Email' type='text' class='gmg_input' value='"+_ss_track.options.visitor_email+"'></div>"+G+e+"<div class='gmg_prechat_sub' style='text-align:center'><input type='submit' value='Start chat' style='font-size:"+C.greet_fs+";height:27px;padding:0 10px;margin:3px 0 20px;background:"+_ss_track.options.title_color+";border:1px solid "+_ss_track.options.title_color+";color:"+_ss_track.options.title_text_color+";border-radius:4px;-moz-border-radius:4px;-webkit-border-radius:4px'></div></form></div><div class='gmg_chat_online'><div class='gmg_agent_info' style='"+(_ss_track.options.img_enable?"":"display:none;")+"padding:5px 5px 7px 5px;background-color:#eee;border-bottom:1px solid #ccc;'><div style='background: url("+location.protocol+"//"+_ss_track.FE_SERVER+"/agent_img/0/) no-repeat 50% 50%;float:left;margin-right:5px;width:"+C.pic_h_w+";height:"+C.pic_h_w+";background-size: contain;' class='gmg_agent_img'> </div><div style='background:url("+location.protocol+"//"+_ss_track.FE_SERVER+"/company_logo/"+_ss_track.id+"/) no-repeat 50% 50%;float:right;width:100px;height:40px'></div><span class='gmg_agent_name' style='display:block;padding-top:5px;font-weight:bold;font-size:"+C.text_fs+";width:70px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;' title='Agent'>Agent</span><span class='gmg_agent_des' style='display:block;padding-top:3px;width:70px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;min-height:14px;' title=''></span></div><div class='gmg_chat_content' style='font-family:arial,sans-serif;height:"+C.chat_cont_h+";width:100%;overflow:auto;background-color:#fff;color:#000;'><div class='gmg_chat_wrap' style='padding:1px;margin:1px;'><div class='gmg_chat_all'><div class='gmg_info_msg gmg_info_msg_top'>"+_ss_track.options.online_greet+"</div></div></div></div><div class='gmg_chat_info' style='font-family:arial,sans-serif;font-size:9px;text-align:right;padding:2px;padding-right:4px;background-color:#fff;color:#777;'>&nbsp;</div><textarea class='gmg_chat_textarea' style='height:48px;width:"+C.textarea_w+";border:0;border-top:1px solid #bbb;border-bottom:1px solid #bbb;padding:4px;color:#000;font-size:"+C.input_fs+" !important;background-color:#fff;resize:none' placeholder='"+_ss_track.options.msg_hint+"'></textarea></div><div class='gmg_chat_offline' style='display:none'><div style='color:#000;background-color:#fff;padding:4px;font-size:"+C.greet_fs+";'>"+_ss_track.options.offline_greet+"</div><form action='javascript:void(0)' class='gmg_chat_form'><div class='gmg_chat_name gmg_inp_div'><input placeholder='Name' type='text' class='gmg_input' value='"+_ss_track.options.visitor_name+"'></div><div class='gmg_chat_email gmg_inp_div'><span class='error'></span><input placeholder='Email' type='text' class='gmg_input' value='"+_ss_track.options.visitor_email+"'></div><div class='gmg_chat_phne gmg_inp_div'><span class='error'></span><input placeholder='Mobile' maxlength='10' type='text' class='gmg_input'></div><div class='gmg_chat_msg gmg_inp_div'><span class='error'></span><textarea placeholder='Type your message here' style='height:"+C.off_msg_h+";' class='gmg_input'></textarea></div><div class='gmg_chat_sub' style='text-align:center'><input type='submit' value='Submit' style='font-size:"+C.greet_fs+";height:27px;padding:0 10px;margin:0 0 6px;background:"+_ss_track.options.title_color+";border:1px solid "+_ss_track.options.title_color+";color:"+_ss_track.options.title_text_color+";border-radius:4px;-moz-border-radius:4px;-webkit-border-radius:4px'></div></form></div><div class='gmg_chat_unavail' style='display:none'><div style='color:#000;background-color:#fff;padding:4px 4px 15px 4px;font-size:"+C.greet_fs+";'>"+_ss_track.options.unavail_greet+"</div></div><div style='color:#000;height:12px;text-align:center;font-size:"+C.power_fs+";background-color:#eee'>Powered by <a href='http://www.gsecondscreen.com/?utm_medium=chat_widget&utm_source="+window.location.hostname+"' target='_new' style='color:#000;'>Gamooga Second Screen</a></div></div></body></html>";var q;if(_ss_track.options.chat_pos==0){q="bottom:0;right:"+_ss_track.options.chat_pos_off+"px"}else{if(_ss_track.options.chat_pos==1){q="bottom:0;left:"+_ss_track.options.chat_pos_off+"px"}else{if(_ss_track.options.chat_pos==2){q="left:0;top:"+_ss_track.options.chat_pos_off+"px;transform:rotate(90deg) translate(0,-100%);transform-origin:0 0;-moz-transform:rotate(90deg) translate(0,-100%);-moz-transform-origin:0 0;-ms-transform:rotate(90deg) translate(0,-100%);-ms-transform-origin:0 0;-webkit-transform:rotate(90deg) translate(0,-100%);-webkit-transform-origin:0 0;-o-transform:rotate(90deg) translate(0,-100%);-o-transform-origin:0 0;filter:progid:DXImageTransform.Microsoft.BasicImage(rotation=1)"}else{if(_ss_track.options.chat_pos==3){var t=-1*_ss_track.options.chat_pos_off-250;q="left:0;top:100%;margin-top:"+t+"px;transform:rotate(90deg) translate(0,-100%);transform-origin:0 0;-moz-transform:rotate(90deg) translate(0,-100%);-moz-transform-origin:0 0;-ms-transform:rotate(90deg) translate(0,-100%);-ms-transform-origin:0 0;-webkit-transform:rotate(90deg) translate(0,-100%);-webkit-transform-origin:0 0;-o-transform:rotate(90deg) translate(0,-100%);-o-transform-origin:0 0;filter:progid:DXImageTransform.Microsoft.BasicImage(rotation=1)"}else{if(_ss_track.options.chat_pos==4){q="right:0;top:"+_ss_track.options.chat_pos_off+"px;transform:rotate(270deg) translate(0,-100%);transform-origin:250px 0;-moz-transform:rotate(270deg) translate(0,-100%);-moz-transform-origin:250px 0;-ms-transform:rotate(270deg) translate(0,-100%);-ms-transform-origin:250px 0;-webkit-transform:rotate(270deg) translate(0,-100%);-webkit-transform-origin:250px 0;-o-transform:rotate(270deg) translate(0,-100%);-o-transform-origin:250px 0;filter:progid:DXImageTransform.Microsoft.BasicImage(rotation=3);-ms-writing-mode:bt-rl"}else{if(_ss_track.options.chat_pos==5){var t=-1*_ss_track.options.chat_pos_off-250;q="right:0;top:100%;margin-top:"+t+"px;transform:rotate(270deg) translate(0,-100%);transform-origin:250px 0;-moz-transform:rotate(270deg) translate(0,-100%);-moz-transform-origin:250px 0;-ms-transform:rotate(270deg) translate(0,-100%);-ms-transform-origin:250px 0;-webkit-transform:rotate(270deg) translate(0,-100%);-webkit-transform-origin:250px 0;-o-transform:rotate(270deg) translate(0,-100%);-o-transform-origin:250px 0;filter:progid:DXImageTransform.Microsoft.BasicImage(rotation=3);-ms-writing-mode:bt-rl"}}}}}}var s="<div class='gmg_chat_outer'><audio preload='none'><source src='//"+_ss_track.FE_SERVER+"/static/swf/chat.mp3' type='audio/mpeg'><source src='//"+_ss_track.FE_SERVER+"/static/swf/chat.wav' type='audio/wav'></audio><iframe allowfullscreen='true' webkitallowfullscreen='true' mozallowfullscreen='true' class='gmg_chat' style='width:"+C.widget_w+(v.mobile?" !important; max-width:500px":"")+";max-height:100%;height:0;position:fixed;"+q+";text-align:left;z-index:9999999999;border:0;-webkit-border-radius:4px 4px 0 0;-moz-border-radius:4px 4px 0 0;border-radius:4px 4px 0 0;box-shadow: 0 0 5px #333' marginheight='0' marginwidth='0' frameborder='0'";var A="></iframe></div>";if(g.browser.webkit){_ss_track.__srcfn=function(){return E};g("body").append(s+" src='javascript:if(parent._ss_track)parent._ss_track.__srcfn()'"+A)}else{g("body").append(s+A);var n=g("iframe.gmg_chat")[0];n.contentWindow.document.open();n.contentWindow.document.write(E);n.contentWindow.document.close()}var b=v.chat_frame=g("iframe.gmg_chat").contents().find("body");g("iframe.gmg_chat").stop().animate({height:v.chat_frame.find(".gmg_chat_head").outerHeight()+"px"},250,"linear");v.chat_shown=false;var J=function(i,j){return function(){return j.apply(i,arguments)}};if(_ss_track.options.chat_close){b.find(".gmg_chat_close").click(function(){v.stop_flick();v.remove_chat_widget()})}if(!_ss_track.options.chat_no_min){b.find(".gmg_chat_head").click(J(v,v.chat_clicked))}var a=null;b.find(".gmg_chat_textarea").keypress(J(v,function(j){var i=this;if(j.which=="13"){i.chat_posted();i.ws.send(String.fromCharCode(x));clearTimeout(a);a=null;if(i.mobile){b.find(".gmg_chat_textarea").blur();if(window.AndroidInterface){window.AndroidInterface.hideKeyboard()}}return false}if(a==null){i.ws.send(String.fromCharCode(p))}clearTimeout(a);a=setTimeout(function(){i.ws.send(String.fromCharCode(x));a=null},5000)}));var H=null;b.find(".gmg_prechat_srvy select").change(function(){var M=g(this).attr("data-set");var O=g(this).val();var L=g(this).find("option:checked").attr("data-show");var i=g(this).find("option:checked").attr("data-route");var j=g(this);while(true){var N=j.data("dep");if(!N){break}j.removeAttr("dep");N.hide();j=N}g("iframe.gmg_chat").css("height",v.chat_frame.css("height"));if(L){b.find(".gmg_prechat_form #pcs_wrap_"+L).show();g(this).data("dep",b.find(".gmg_prechat_form #pcs_wrap_"+L));g("iframe.gmg_chat").css("height",v.chat_frame.css("height"))}if(i){H=i}});if(H=="0"){H=null}if(v.sess_conf.settings.depts.length>0){v.update_online_depts()}b.find(".gmg_prechat_form").submit(function(O){var j=b.find(".gmg_prechat_name input").val();var i=b.find(".gmg_prechat_email input").val();var N=false;b.find(".gmg_prechat_srvy .grq").css("border","1px solid #ccc").prev().hide();b.find(".gmg_prechat_srvy .grq").each(function(){if(g(this).is(":visible")&&(g(this).val()==null||g(this).val()=="")){g(this).css("border","1px solid red");g(this).prev().html(" (required)").show();N=true}});b.find(".gmg_prechat_email input").css("border","1px solid #ccc");b.find(".gmg_prechat_email span.error").hide();if(i==""){b.find(".gmg_prechat_email input").css("border","1px solid red");b.find(".gmg_prechat_email span.error").html(" (required)").show();N=true}else{if(!/[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]+/i.test(i)){b.find(".gmg_prechat_email input").css("border","1px solid red");b.find(".gmg_prechat_email span.error").html(" (valid email required)").show();N=true}}b.find(".gmg_prechat_dept select").css("border","1px solid #ccc");if(b.find(".gmg_prechat_dept select").length>0){if(!b.find(".gmg_prechat_dept select").val()){b.find(".gmg_prechat_dept select").css("border","1px solid red");N=true}}if(!N){v.finish_prechat();if(b.find(".gmg_prechat_dept select").length>0){v.ws.send(String.fromCharCode(I)+b.find(".gmg_prechat_dept select").val())}else{if(H&&H!="0"){v.ws.send(String.fromCharCode(I)+H)}}var M=[];var L=[];b.find(".gmg_prechat_srvy input,.gmg_prechat_srvy select").each(function(){if(g(this).val()!=""){M.push([g(this).attr("id"),g(this).val()])}L.push([g(this).siblings(".ques").text(),g(this).val()])});v.ws.send(String.fromCharCode(c)+j+w+i+w+JSON.stringify(L));if(j!=_ss_track.options.visitor_name||i!=_ss_track.options.visitor_email||M.length>0){g.ajax({type:"GET",url:"//"+_ss_track.GMG_SERVER+"/vnameemail_post/",data:{cid:_ss_track.id,vid:v.user_data.cookie_id,name:j,email:i,pcsdj:JSON.stringify(M)},dataType:"jsonp",success:function(Q){if(Q=="0"){var P=_ss_track.DEV?"_ssd_v":"_ss_v";var T="";if(!_ss_track.DEV){var R=location.hostname.split(".");var S=(R[R.length-2].length==2)?R.length-3:R.length-2;T=";domain="+R.slice(S).join(".")}document.cookie=P+"="+v.user_data.cookie_id+"|"+SecondScreenUtils.base64encode(JSON.stringify({name:j,email:i}))+";path=/;max-age=630720000;expires="+new Date((new Date().getTime())+630720000000).toUTCString()+T}}})}}g("iframe.gmg_chat").css("height",v.chat_frame.css("height"))});b.find(".gmg_chat_form").submit(function(N){var L=b.find(".gmg_chat_name input").val();var j=b.find(".gmg_chat_email input").val();var P=b.find(".gmg_chat_msg textarea").val();var i=b.find(".gmg_chat_phne input").val();var M=false;b.find(".gmg_chat_phne input").css("border","1px solid #ccc");b.find(".gmg_chat_email input").css("border","1px solid #ccc");b.find(".gmg_chat_msg textarea").css("border","1px solid #ccc");b.find(".gmg_chat_email span.error").hide();b.find(".gmg_chat_msg span.error").hide();b.find(".gmg_chat_phne span.error").hide();if(!M){b.find(".gmg_chat_sub input").val("Sending...");b.find(".gmg_chat_sub input").attr("disabled","disabled");var O=SecondScreen._read_sess_data("assign_dept")||0;g.ajax({type:"GET",url:"//"+_ss_track.GMG_SERVER+"/offline_mail/",data:{id:_ss_track.id,n:L,e:j,p:i,m:P,l:location.href,d:O},dataType:"jsonp",success:function(R){if(R[0]=="0"){b.find(".gmg_chat_sub input").val("Sent!");setTimeout(function(){b.find(".gmg_chat_name input").val("");b.find(".gmg_chat_email input").val("");b.find(".gmg_chat_msg textarea").val("");b.find(".gmg_chat_sub input").val("Submit");b.find(".gmg_chat_sub input").removeAttr("disabled")},4000)}else{if(R[0]=="-1"){var Q=R[1];if(Q.e){b.find(".gmg_chat_email span.error").html(" "+Q.e).show();b.find(".gmg_chat_email input").css("border","1px solid red")}if(Q.p){b.find(".gmg_chat_phne span.error").html(" "+Q.p).show();b.find(".gmg_chat_phne input").css("border","1px solid red")}if(Q.m){b.find(".gmg_chat_msg span.error").html(" "+Q.m).show();b.find(".gmg_chat_msg textarea").css("border","1px solid red")}b.find(".gmg_chat_sub input").val("Error! Try again.");setTimeout(function(){b.find(".gmg_chat_sub input").val("Submit");b.find(".gmg_chat_sub input").removeAttr("disabled")},4000);g("iframe.gmg_chat").css("height",v.chat_frame.css("height"))}}}}).error(function(){b.find(".gmg_chat_sub input").val("Error! Try again.");setTimeout(function(){b.find(".gmg_chat_sub input").val("Submit");b.find(".gmg_chat_sub input").removeAttr("disabled")},4000)})}N.preventDefault()});b.click(function(){v.stop_flick()})};SecondScreen.prototype.is_chatting=function(){var b=SecondScreenUtils.$;var a=this;return !!SecondScreen._read_sess_data("__ss_support")};SecondScreen.prototype.attach_altid=function(b,a){var d=SecondScreenUtils.$;var c=this;d.ajax({type:"GET",url:"//"+_ss_track.GMG_SERVER+"/valtid_post/",data:{cid:_ss_track.id,vid:c.user_data.cookie_id,altid:b},dataType:"jsonp",success:function(e){if(e=="0"){if(a){a(true)}}else{if(a){a(false)}}}})};SecondScreen.prototype.show_chat_widget=function(){var b=SecondScreenUtils.$;var a=this;if(!a.chat_enabled){return}b(".gmg_chat_outer").show()};SecondScreen.prototype.hide_chat_widget=function(){var b=SecondScreenUtils.$;var a=this;if(!a.chat_enabled){return}b(".gmg_chat_outer").hide()};SecondScreen.prototype.remove_chat_widget=function(){var b=SecondScreenUtils.$;var a=this;if(!a.chat_enabled){return}SecondScreen._del_sess_data("__ss_chat");a.chat_enabled=false;b(".gmg_chat_outer").remove()};SecondScreen.prototype.live_chat_click=function(d,e,b){var c=SecondScreenUtils.$;var a=this;if(!a.chat_enabled){if(a.chat_enabled_by_agent){a.chat_enabled=true;a.add_chat_widget();if(a.prechat_enabled){a.chat_frame.find(".gmg_chat_online").hide();a.chat_frame.find(".gmg_prechat_online").show()}if(a.offline_message_disabled&&!a.unavail_greet_enabled){a.hide_chat_widget()}}else{return}}if(a.agent_present){if(a.offline_message_disabled&&!a.unavail_greet_enabled){a.show_chat_widget();a.chat_show();return}if(a.prechat_enabled){a.chat_frame.find(".gmg_prechat_online").show()}else{a.chat_frame.find(".gmg_chat_online").show()}if(!a.offline_message_disabled){a.chat_frame.find(".gmg_chat_offline").hide()}else{a.chat_frame.find(".gmg_chat_unavail").hide()}if(a.chat_shown){c("iframe.gmg_chat").css("height",a.chat_frame.css("height"))}a.chat_frame.find(".gmg_chat_head b").html(_ss_track.options.online_title);a.chat_show();if(b){a.finish_prechat()}if(a.prechat_enabled&&(d||e)){if(d){a.chat_frame.find(".gmg_prechat_name input").val(d)}if(e){a.chat_frame.find(".gmg_prechat_email input").val(e)}a.chat_frame.find(".gmg_prechat_form").submit()}}else{if(a.offline_message_disabled&&!a.unavail_greet_enabled){a.hide_chat_widget();return}if(a.prechat_enabled){a.chat_frame.find(".gmg_prechat_online").hide()}else{a.chat_frame.find(".gmg_chat_online").hide()}if(!a.offline_message_disabled){a.chat_frame.find(".gmg_chat_offline").show();a.chat_frame.find(".gmg_chat_head b").html(_ss_track.options.offline_title)}else{a.chat_frame.find(".gmg_chat_unavail").show();a.chat_frame.find(".gmg_chat_head b").html(_ss_track.options.unavail_title)}if(a.chat_shown){c("iframe.gmg_chat").css("height",a.chat_frame.css("height"))}a.chat_show()}};SecondScreen.prototype.chat_toggle=function(){var b=SecondScreenUtils.$;var a=this;if(!a.chat_enabled){return}if(a.chat_shown){a.chat_frame.find(".gmg_chat_arrow").html("&#x25B2;");b("iframe.gmg_chat").stop().css("height",a.chat_frame.find(".gmg_chat_head").outerHeight()+"px");if(_ss_track.options.chat_size==1){b("iframe.gmg_chat").css("width","300px")}if(_ss_track.options.chat_pos==2||_ss_track.options.chat_pos==3){b("iframe.gmg_chat").css({transform:"rotate(90deg) translate(0,-100%)","-webkit-transform":"rotate(90deg) translate(0,-100%)","-moz-transform":"rotate(90deg) translate(0,-100%)","-ms-transform":"rotate(90deg) translate(0,-100%)","-o-transform":"rotate(90deg) translate(0,-100%)",filter:"progid:DXImageTransform.Microsoft.BasicImage(rotation=1)"})}else{if(_ss_track.options.chat_pos==4||_ss_track.options.chat_pos==5){b("iframe.gmg_chat").css({transform:"rotate(270deg) translate(0,-100%)","-webkit-transform":"rotate(270deg) translate(0,-100%)","-moz-transform":"rotate(270deg) translate(0,-100%)","-ms-transform":"rotate(270deg) translate(0,-100%)","-o-transform":"rotate(270deg) translate(0,-100%)",filter:"progid:DXImageTransform.Microsoft.BasicImage(rotation=3)"})}}a.chat_shown=false;SecondScreen._write_sess_data("__ss_chat","0");a.chat_frame.css("overflow","hidden")}else{a.chat_frame.find(".gmg_chat_arrow").html("&#x25BC;");if(_ss_track.options.chat_size==1){b("iframe.gmg_chat").css("width","450px")}b("iframe.gmg_chat").stop().css("height",a.chat_frame.css("height"));if(_ss_track.options.chat_pos>=2){b("iframe.gmg_chat").css({transform:"none","-webkit-transform":"none","-moz-transform":"none","-ms-transform":"none","-o-transform":"none",filter:"none"})}a.chat_shown=true;var c=a.chat_frame.find(".gmg_chat_content");c.stop().scrollTop(c[0].scrollHeight);SecondScreen._write_sess_data("__ss_chat","1");if(a.unread_chat_show_interval!==null){a.unread_chat_count=0;clearInterval(a.unread_chat_show_interval);a.unread_chat_show_interval=null;a.unread_chat_show_helper=0;a.chat_frame.find(".gmg_chat_head b").html(_ss_track.options.online_title)}a.chat_frame.css("overflow","auto")}};SecondScreen.prototype.chat_clicked=function(){var b=SecondScreenUtils.$;var a=this;a.chat_toggle()};SecondScreen.prototype.chat_show=function(){var b=SecondScreenUtils.$;var a=this;a.chat_shown=false;a.chat_toggle()};SecondScreen.prototype.chat_hide=function(){var b=SecondScreenUtils.$;var a=this;a.chat_shown=true;a.chat_toggle()};SecondScreen.prototype.chat_posted=function(){var f=SecondScreenUtils.$;var d=this;if(!d.chat_enabled){return}var c=77;var e=48;var b=6;var g=d.chat_frame.find(".gmg_chat_textarea").val();if(g==""){return}g=g.substr(0,1024);d.chat_frame.find(".gmg_chat_textarea").val("");d.add_chat_message("You",g);d.ws.send(String.fromCharCode(c)+g);var a=SecondScreen._read_sess_data("analytic_latest_trigger");if(a){d.ws.send(String.fromCharCode(e)+String.fromCharCode(b)+a);SecondScreen._write_sess_data("analytic_lastest_chat_trigger",a);SecondScreen._del_sess_data("analytic_latest_trigger")}};SecondScreen.prototype.add_info_message=function(c){var b=SecondScreenUtils.$;var a=this;a._add_message("<div class='gmg_info_msg'>"+c+"</div>")};SecondScreen.prototype.add_status_message=function(c){var b=SecondScreenUtils.$;var a=this;a._add_message("<i>"+c+"</i>")};SecondScreen.prototype.agent_calling=function(){var b=this;b.chat_frame.find(".agentcall-outer").remove();var a='<div class="agentcall-outer" style="position:absolute;z-index:99999;width:60%;height:auto;margin:20%;z-index:999999;background-color:rgba(0,0,0,0.8);box-shadow:0px 0px 5px rgba(0,0,0,0.6);border-radius:10px;padding-bottom:10px;"><div class="call-inner" style="margin:0px;display:block;"><p align="center" style="margin:0px;color:#fff;font-size:14px;padding:7px 0 7px 10px;border-bottom:1px solid;">Incoming Call</p><p align="left" style="margin:0 0 0 10px;color:#fff;font-size:14px;padding:7px 0 7px 10px;">John is calling... </p><div align="center" style="width:33%;display:inline-block;"><div class="circle green" style="display:inline-block;width:33px;height:33px;"><img src="'+location.protocol+"//"+_ss_track.FE_SERVER+'/static/images/audiovideo/startcall.png" style="margin:8px 7px;width: 24px;height: 24px;"/></div></div><div align="center" style="width:33%;display:inline-block;"><div class="circle green" style="display:inline-block;width:33px;height:33px;"><img src="'+location.protocol+"//"+_ss_track.FE_SERVER+'/static/images/audiovideo/startvideo.png" style="margin:8px 7px;width: 24px;height: 24px;"/></div></div><div align="center" style="width:33%;display:inline-block;"><div class="circle red" style="display:inline-block;width:33px;height:33px;"><img src="'+location.protocol+"//"+_ss_track.FE_SERVER+'/static/images/audiovideo/reject.png" style="margin:8px 7px;width: 24px;height: 24px;"/></div></div></div></div>';b.chat_frame.find(".gmg_chat_content .gmg_chat_all").prepend("<div class='gmg_chat_line'>"+a+"</div>")};SecondScreen.prototype.on_calling_option=function(){var b=this;b.chat_frame.find(".oncall-outer").remove();var a='<div class="oncall-outer" style="position:absolute;z-index:99999;padding-bottom:5px;margin-top:-3px;width:99%;height:auto;  background-color: rgba(0,0,0,0.7);"><div class="oncall-inner" style="margin:0px;display:block;"><div align="center" style="display:inline-block;float:right;"><div class="circle red" style="display:inline-block;width:25px;height:25px;padding:3px;margin: 4px 8px 0px 5px;"><img src="'+location.protocol+"//"+_ss_track.FE_SERVER+'/static/images/audiovideo/reject.png" style="width:24px;height:24px;"/></div></div><div class="oncall_video_btn" align="center" style="display:inline-block;float:right;display:none;"><div class="circle green" style="display:inline-block;width:25px;height:25px;padding:3px;margin: 4px 5px 0px 5px;"><img src="'+location.protocol+"//"+_ss_track.FE_SERVER+'/static/images/audiovideo/video.png" style="width:24px;height:24px;"/></div></div><div align="center" style="display:inline-block;float:right;"><div class="circle green" style="display:inline-block;width:25px;height:25px;padding:3px;margin: 4px 5px 0px 5px;"><img src="'+location.protocol+"//"+_ss_track.FE_SERVER+'/static/images/audiovideo/mute.png" style="width: 24px;height: 24px;"/></div></div></div></div>';b.chat_frame.find(".gmg_chat_content .gmg_chat_all").prepend("<div class='gmg_chat_line'>"+a+"</div>");b.chat_frame.find(".gmg_info_msg_top").css("margin-top","40px")};SecondScreen.prototype.addVideoFrame=function(){var a=this;var b='<div class="oncall_videobox"><video class="agent_video_box" style="width: 100%;background-color: #7A7A7A;height: 145px;"></video><br><video class="visitor_video_box" style="background-color: #383838;position: absolute;width:30%;height:50px;margin-top:-55px;border-top: 2px solid rgba(255,255,255,0.5);border-right: 2px solid rgba(255,255,255,0.5);"></video><div class="circle video_fullscreen" style="position: absolute;weight:28px;height:28px;border-radius:50px;margin: -40px 7px 0 0;border: 2px solid rgba(255,255,255,0.5);background-color: rgba(0,0,0,0.6);right: 0;"><img src="'+location.protocol+"//"+_ss_track.FE_SERVER+'/static/images/audiovideo/maximize.png" style="margin:7px 7px;width: 14px;height: 14px;vertical-align: middle;"/></div></div>';a.chat_frame.find(".oncall-inner").prepend(b);a.chat_frame.find(".oncall-outer").css("padding-bottom","5px");a.chat_frame.find(".oncall-inner").css("display","block");a.chat_frame.find(".oncall_video_btn").css("display","block");a.chat_frame.find(".gmg_info_msg_top").css("margin-top","188px");a.chat_frame.find(".gmg_chat_content").css("height","350px");a.chat_frame.find(".gmg_chat_textarea").css("height","25px");$("iframe.gmg_chat").css("height",a.chat_frame.css("height"));a.chat_frame.find(".toggle_calloption").unbind("click");a.chat_frame.find(".video_fullscreen").click(function(c){a.toggleFullScreen()})};SecondScreen.prototype.toggleFullScreen=function(){var a=this;var b=a.chat_frame.find(".agent_video_box")[0];if(b.requestFullscreen){b.requestFullscreen()}else{if(b.mozRequestFullScreen){b.mozRequestFullScreen()}else{if(b.webkitRequestFullscreen){b.webkitRequestFullscreen()}else{if(b.msRequestFullscreen){b.msRequestFullscreen()}}}}};SecondScreen.prototype.visitor_calloption=function(){var b=this;b.chat_frame.find(".visitorcall-outer").remove();var a='<div class="visitorcall-outer" style="margin-top:-3px;width:100%;height:40px;background-color:rgba(0,0,0,0.7);"><div class="call-inner" style="margin:0px;display:block;"><span class="connect" style="color:#fff;font-size:14px;margin:12px 0 0 10px;float:left;"></span><div class="circle video" style="float:right;display:inline-block;"><img src="'+location.protocol+"//"+_ss_track.FE_SERVER+'/static/images/audiovideo/startvideo.png" style="margin:8px 17px 0px 0px;width:24px;height:24px;vertical-align: middle;"/></div><div class="circle audio" style="float:right;display:inline-block;"><img src="'+location.protocol+"//"+_ss_track.FE_SERVER+'/static/images/audiovideo/startcall.png" style="margin:8px 17px 0px 0px;width:24px;height:24px;vertical-align: middle;"/></div></div></div>';b.chat_frame.find(".gmg_chat_content .gmg_chat_all").prepend("<div class='gmg_chat_line'>"+a+"</div>")};SecondScreen.prototype.after_visitor_calloption=function(b){var a=this;if(b=="audio"){a.chat_frame.find(".visitorcall-outer .connect").html('<img style="width:14px;height:14px;vertical-align:middle;" src="'+location.protocol+"//"+_ss_track.FE_SERVER+'/static/images/audiovideo/call.png"/> Connecting...');a.chat_frame.find(".visitorcall-outer .video").css("display","none");a.chat_frame.find(".visitorcall-outer .audio img").attr("src",location.protocol+"//"+_ss_track.FE_SERVER+"/static/images/audiovideo/reject.png");a.chat_frame.find(".visitorcall-outer .audio").css({"margin-right":"10px"})}if(b=="video"){a.chat_frame.find(".visitorcall-outer .connect").html('<img style="width:14px;height:14px;vertical-align:middle;" src="'+location.protocol+"//"+_ss_track.FE_SERVER+'/static/images/audiovideo/video.png"/> Connecting...');a.chat_frame.find(".visitorcall-outer .audio").css("display","none");a.chat_frame.find(".visitorcall-outer .video img").attr("src",location.protocol+"//"+_ss_track.FE_SERVER+"/static/images/audiovideo/reject.png");a.chat_frame.find(".visitorcall-outer .video").css({"margin-right":"10px"})}};SecondScreen.prototype.closeAudioVideo=function(){var a=this;a.chat_frame.find(".oncall-outer").remove();a.chat_frame.find(".gmg_info_msg_top").css("margin-top","3px");a.chat_frame.find(".gmg_chat_content").css("height","253px");a.chat_frame.find(".gmg_chat_textarea").css("height","48px");$("iframe.gmg_chat").css("height",a.chat_frame.css("height"))};SecondScreen.prototype.add_chat_message=function(b,d){var c=SecondScreenUtils.$;var a=this;b=b.replace(/<|>/g,function(e){return e=="<"?"&lt;":"&gt;"});d=d.replace(/<|>/g,function(e){return e=="<"?"&lt;":"&gt;"}).replace(a.url_regex,function(f,h){var g="";if(!h){g="http://"}var e=document.createElement("a");e.href=g+f;if(e.host==""){e.href=e.href}if(e.host==window.location.host){return'<a target="_top" href="'+g+f+'">'+f+"</a>"}else{return'<a target="_new" href="'+g+f+'">'+f+"</a><small>&#x279A;</small>"}}).replace(/\[(\/?)((b)|(i)|(u)|(table)|(tr)|(td)|(th)|(ul)|(ol)|(li)|(br))\]/g,"<$1$2>");if(!_ss_track.options.img_enable){a.agent_id=0}if(a.agent_id==null){a.agent_id=0}if(b=="You"){msg='<div style="clear:both;"><img src="'+location.protocol+"//"+_ss_track.FE_SERVER+'/static/images/user_chat_icon.png" style="float: right;margin:8px 4px 0 0;width:24px;height:24px;border-radius:24px;"><span style="border: 5px solid #e5e5e5;float: right;right: 0;-ms-transform: rotate(45deg);-webkit-transform: rotate(45deg);transform: rotate(45deg);margin: 12px 4px 0 -9px;"></span><span style="border: 5px solid #fbfbfb;float: right;right: 0;-ms-transform: rotate(45deg); -webkit-transform: rotate(45deg);transform: rotate(45deg);margin: 12px 0 0 -9px;"></span><p style="float:right;background-color:#fbfbfb;padding: 4px 10px 4px 5px;border:1px solid #e5e5e5;border-radius:4px;margin:3px 3px 0 0;max-width:70%;word-wrap:break-word;margin-bottom:10px;"><b>'+b+"</b><br>"+d+"</p></div>"}else{msg='<div style="clear:both;"><img class="chat_agent_img_ico" src="'+location.protocol+"//"+_ss_track.FE_SERVER+"/agent_img/"+a.agent_id+'/" style="float:left;margin:8px 4px 0 3px;width:24px;height:24px;border-radius:24px;"><span style="border: 5px solid #cbe7f5;float:left;right: 0;-ms-transform: rotate(45deg);-webkit-transform: rotate(45deg);transform: rotate(45deg);margin: 12px 0 0 1px;"></span><span style="border: 5px solid #E4F1FA;float:left;right: 0;-ms-transform: rotate(45deg); -webkit-transform: rotate(45deg);transform: rotate(45deg);margin: 12px 0 0 -9px;"></span><p style="background-color:#e4f1fa;padding: 4px 5px 4px 10px;border:1px solid #cbe7f5;border-radius:4px;margin:0 0 0 -6px;max-width:70%;word-wrap:break-word;margin-bottom:10px;float:left;"><b>'+(b!=""?b:"Agent")+"</b><br>"+d+"</p></div>"}a._add_message(msg)};SecondScreen.prototype._add_message=function(c){var b=SecondScreenUtils.$;var a=this;if(!a.chat_enabled){return}if(a.prechat_enabled){a.finish_prechat()}a.chat_frame.find(".gmg_chat_content .gmg_chat_all").append("<div class='gmg_chat_line'>"+c+"</div>");a.chat_frame.find(".gmg_chat_content").stop().animate({scrollTop:a.chat_frame.find(".gmg_chat_content")[0].scrollHeight},"slow")};SecondScreen.prototype.finish_prechat=function(){var b=SecondScreenUtils.$;var a=this;a.prechat_enabled=false;if(a.agent_present){a.chat_frame.find(".gmg_chat_online").show();a.chat_frame.find(".gmg_prechat_online").hide();if(a.chat_shown){b("iframe.gmg_chat").css("height",a.chat_frame.css("height"))}}SecondScreen._write_sess_data("__ss_prechat","1")};SecondScreen._read_sess_data=function(a){if(SecondScreen._sstore.hasOwnProperty(a)){return JSON.parse(SecondScreen._sstore[a])}else{return null}};SecondScreen._write_sess_data=function(b,a){var c=JSON.stringify(a);SecondScreen._sstore[b]=c;SecondScreen._xds.setSSItem(b,c)};SecondScreen._del_sess_data=function(a){delete SecondScreen._sstore[a];SecondScreen._xds.removeSSItem(a)};SecondScreen.prototype._notif_click=function(h,b){var d=this;var g=SecondScreenUtils.$;var f=48;var e=5;if(h!="-"){d.ws.send(String.fromCharCode(f)+String.fromCharCode(e)+h);var a=SecondScreen._read_sess_data("analytic_notifclick")||{};a[h]=true;SecondScreen._write_sess_data("analytic_notifclick",a)}if(b){var c=g(b).attr("href");if(c){setTimeout(function(){window.location.href=c},250)}return false}else{return true}};SecondScreen._show_notification=function(c,p){if(c.nact==1){if(p&&(!_ss_track.api.agent_present||SecondScreen._read_sess_data("__ss_support"))){return}if(c.hpcs==true){c.lnk="javascript:parent._ss_track.api.live_chat_click(null,null,true);"}else{c.lnk="javascript:parent._ss_track.api.live_chat_click();"}}var f=SecondScreenUtils.$;var h=["","arial, helvetica, sans-serif",'"times new roman", serif','"arial black", sans-serif','"arial narrow", sans-serif','"courier new", monospace',"garamond, serif","georgia, serif","tahoma, sans-serif",'"trebuchet ms", sans-serif',"verdana, sans-serif"];var g=c.lnk;if(g!=""){if(g.substr(0,4)!="http"&&g.substr(0,11)!="javascript:"){g="http://"+g}}var e="<!DOCTYPE html><html><head><base target='_top'><style type='text/css'>* {padding:0;margin:0;} a {text-decoration:none;} ul,ol {margin-left:30px;padding-left:10px;} .gmgbutton {padding:5px 10px;display:inline;background:#777 url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAABkCAYAAABHLFpgAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAALdJREFUeNrEjkEWwiAQQyGlwOAN3Hv/m3UnA62vONF2p25lkfeTwAx+CuEWYgguxBgdYoo7YkwDOWeKDEjOO6TQStlRXlkRIylGl3JQYSaFJGxJIq9M2No9OYbuSOncYXuHWZN5Nglhcm6M4eDsfJDrt+Jv8vO7hyzL4rFtD8rmsPbu0bcOtEZq6tG0eVSKqlqhldao1grL2NY728qMhdozfbfqz3sc1dpBnYvMeqyrbet99U8BBgCRTXT4kGguQQAAAABJRU5ErkJggg==) repeat-x bottom;border: none;color:#fff;cursor:pointer;font-weight:bold;border-radius:3px;-moz-border-radius:3px;-webkit-border-radius:3px;} .gmgbutton:hover {background-position:0 center;} .gmgbutton:active {position: relative;top: 1px;}</style></head><body style='background-color:transparent;overflow:hidden;'>";var j=f("<div/>");if(c.io){j.append("<div class='close' style='color:#fff;cursor:pointer;font-size:13px;position:absolute;right:0;background:#000;border-bottom-left-radius:5px;padding:1px 3px' onclick='parent._ss_track.__notifpreviewclosefn("+c.nst+")'>&#x2715;</div>")}else{j.append("<div class='close' style='color:"+c.tc+";cursor:pointer;font-size:13px;float:right;padding:1px 3px' onclick='parent._ss_track.__notifpreviewclosefn("+c.nst+")'>&#x2715;</div>")}if((typeof c.nst=="undefined"||c.nst!=2)&&!c.io&&c.ttl!=""){j.append("<div class='title' style='color:"+c.tc+";font-size:"+(c.ts||20)+"px;font-family:"+h[(c.tf||1)]+";padding:5px 10px;'>"+c.ttl+"</div>")}if(c.io){j.append("<div class='content' style='padding:0;'><img src='"+c.cimgurl+"' style='height:"+c.cimgh+"px;width:"+c.cimgw+"px;display:block'></div>")}else{j.append("<div class='content' style='color:"+c.cc+";font-size:"+(c.cs||13)+"px;font-family:"+h[(c.cf||1)]+";padding:5px 10px;'>"+c.ctext+"</div>")}if(c.cta&&!c.io){if(g==""){g="javascript:void(0)"}var q="'background-color:"+c.ctabc+";color:"+c.ctatc+";font-size:"+c.ctas+"px;font-family:"+h[c.ctaf]+";padding:5px 10px;margin:10px;display:inline-block;'";if(g.substr(0,11)=="javascript:"){j.append("<div class='cta'><a "+(c.ctac?"onmouseup='javascript:setTimeout(function() { parent._ss_track.__notifpreviewclosefn("+c.nst+")},150)' ":"")+"style="+q+" class='gmgbutton' href='"+g+"'>"+c.cta+"</a></div>")}else{var x=c.ltrg;if(!p){p="-"}if(x=="1"){j.append("<div class='cta'><a "+(c.ctac?"onmouseup='javascript:setTimeout(function() { parent._ss_track.__notifpreviewclosefn("+c.nst+")},150)' ":"")+"style="+q+" class='gmgbutton' href='"+g+"' onclick='javascript:return parent._ss_track.api._notif_click(\""+p+"\",this)' target='_top'>"+c.cta+"</a></div>")}else{j.append("<div class='cta'><a "+(c.ctac?"onmouseup='javascript:setTimeout(function() { parent._ss_track.__notifpreviewclosefn("+c.nst+")},150)' ":"")+"style="+q+" class='gmgbutton' href='"+g+"' onclick='javascript:return parent._ss_track.api._notif_click(\""+p+"\")' target='_blank'>"+c.cta+"</a></div>")}}}if(!c.io){if(c.nst!=2){if(c.ctaa==2){j.find("div.cta").css("text-align","center")}else{if(c.ctaa==3){j.find("div.cta").css("text-align","right")}else{if(c.ctaa>=4){j.find("div.cta").detach().insertBefore(j.find("div.content"));if(c.ctaa==4){j.find("div.cta").css({"float":"left",margin:"8px 3px 0 0"})}else{if(c.ctaa==5){j.find("div.cta").css({"float":"right",margin:"8px 0 0 3px"})}else{if(c.ctaa==6){j.find("div.cta").css("text-align","center")}}}}}}}else{j.find("div.cta").css("display","inline-block")}}if(g!=""&&(!c.cta||c.io)){if(g.substr(0,11)=="javascript:"){j.wrapInner("<a href='"+g+"' onclick='javascript:return parent._ss_track.api._notif_click(\""+p+"\")'></a>")}else{var x=c.ltrg;if(x=="1"){j.wrapInner("<a href='"+g+"' target='_top' onclick='javascript:return parent._ss_track.api._notif_click(\""+p+"\",this)'></a>")}else{j.wrapInner("<a href='"+g+"' target='_blank' onclick='javascript:return parent._ss_track.api._notif_click(\""+p+"\")'></a>")}}}if(c.nst==1||c.nst==3){j.find("div.close").css({"font-size":"15px"})}else{if(c.nst==2){j.find("div.close").css({padding:"8px 8px 0 4px","font-size":"15px",color:c.cc});j.find("a.gmgbutton").css({display:"inline-block"});j.find("div.content").css({display:"inline-block"});j.find("div.title").css({display:"inline-block"});j.wrapInner("<div class='centerwrap' style='text-align:center'></div>")}}_ss_track.__notifpreviewclosefn=_ss_track.__notifpreviewclosefn||function(z){if(z==3){clearInterval(f("#__ss_notif_frame_"+z).data("updateint"))}f("#__ss_notif_frame_"+z).parent().remove();if(z==2){f("#__ss_notif_pad").remove()}};if(f("#__ss_notif_frame_"+c.nst).length!=0){if(c.nst==3){clearInterval(f("#__ss_notif_frame_"+c.nst).data("updateint"))}f("#__ss_notif_frame_"+c.nst).parent().remove();if(c.nst==2){f("#__ss_notif_pad").remove()}}var i="<div style='position:absolute;top:0;left:0'><iframe style='position:fixed;display:block;bottom:-1px;text-align:left;z-index:9999999999;border:0;background-color:#fff;overflow:hidden;border:1px solid #666;height:0;box-sizing:content-box' marginheight='0' marginwidth='0' frameborder='0' id='__ss_notif_frame_"+c.nst+"'></iframe>";var o=f(window).width();if(c.cimgw>=o){c.cimgw=(o*90)/100;j.find("div.close").css({position:"fixed",right:"0px"})}else{if(c.w>=o){c.w=(o*90)/100;j.find("div.close").css({position:"fixed",right:"0px"})}}f("body").append(i);var n=f("#__ss_notif_frame_"+c.nst);n.css("border-color",c.bc);n.css("background-color",c.bgc);if(typeof c.nst=="undefined"||c.nst==0){if(c.io){n.css("width",c.cimgw+"px")}else{n.css("width",c.w+"px")}if(typeof c.br=="undefined"||c.br==true){n.css({"-webkit-border-radius":"5px 5px 0 0","-moz-border-radius":"5px 5px 0 0","border-radius":"5px 5px 0 0"})}if(typeof c.bs=="undefined"||c.bs==true){n.css({"box-shadow":"0 0 5px #999"})}if(c.pos=="1"){n.css("left","10px");n.css("right","auto")}else{if(c.pos=="2"){n.css("right","10px");n.css("left","auto")}}}else{if(c.nst==1){if(c.io){n.css("width",c.cimgw+"px")}else{n.css("width",c.w+"px")}n.css("border-width","1px");if(typeof c.br=="undefined"||c.br==true){n.css({"-webkit-border-radius":"5px","-moz-border-radius":"5px","border-radius":"5px"})}if(typeof c.bs=="undefined"||c.bs==true){n.css({"box-shadow":"0 0 5px #999"})}n.parent().prepend('<div style="position:fixed;top:0;right:0;height:100%;width:100%;background:#000;opacity:0.8;z-index:9999999998"  class="gmg_notif_overlay">&nbsp;</div>');n.css({bottom:"auto",top:"50%",left:"50%",right:"auto","margin-top":"-100px"});if(!c.io){n.css({"margin-left":"-"+(c.w/2)+"px"})}else{n.css({"margin-left":"-"+(c.cimgw/2)+"px"})}}else{if(c.nst==2){n.css("width","100%");j.find(".gmgbutton").css("margin","4px");n.css({"border-left":"0","border-right":"0"});if(c.pos=="1"){n.css({bottom:"auto","border-bottom-width":"2px","border-top":"0",position:"fixed",top:"0"});f("body").prepend("<div id='__ss_notif_pad' style='position:static;height:0px;'></div>")}else{if(c.pos=="2"){n.css({"border-top-width":"2px","border-bottom":"0",position:"fixed",bottom:"0"})}}}else{if(c.nst==3){if(c.io){n.css("width",c.cimgw+"px")}else{n.css("width",c.w+"px")}n.css("border-width","1px");if(typeof c.br=="undefined"||c.br==true){n.css({"-webkit-border-radius":"5px","-moz-border-radius":"5px","border-radius":"5px"})}if(typeof c.bs=="undefined"||c.bs==true){n.css({"box-shadow":"0 0 5px #999"})}n.css({bottom:"auto"});var a=20;var k=20;var d=f(c.coe);var v=d.position();var s=d.offsetParent();n.parent().css({position:"static",top:"auto",left:"auto"});n.parent().detach().appendTo(s);var b,m,u,t;if(c.cop==1){b=v.left+d.outerWidth()/2+(c.col-0);m=v.top-10-k+(c.cot-0);if(c.io){u=b-c.cimgw/2}else{u=b-c.w/2}t=m;n.css({position:"absolute",top:t+"px",left:u+"px"});n.after('<div style="position:absolute;left:'+(b-a/2)+"px;top:"+(m-1)+"px;border-top:"+k+"px solid "+c.bgc+";border-left:"+(a/2)+"px solid transparent;border-right:"+(a/2)+'px solid transparent;height:0;width:0;z-index:99999999999;">&nbsp;</div>');var w=2;var y=1;n.after('<div style="position:absolute;left:'+(b-(a/2)-y)+"px;top:"+(m-1)+"px;border-top:"+(k+w)+"px solid "+c.bc+";border-left:"+(a/2+y)+"px solid transparent;border-right:"+(a/2+y)+'px solid transparent;height:0;width:0;z-index:99999999999;"></div>')}else{if(c.cop==2){b=v.left-a-10+(c.col-0);m=v.top+d.outerHeight()/2+(c.cot-0);if(c.io){u=b-2-c.cimgw}else{u=b-2-c.w}t=m;n.css({position:"absolute",top:t+"px",left:u+"px"});n.after('<div style="position:absolute;left:'+(b-1)+"px;top:"+(m-k/2)+"px;border-left:"+a+"px solid "+c.bgc+";border-bottom:"+(k/2)+"px solid transparent;border-top:"+(k/2)+'px solid transparent;height:0;width:0;z-index:99999999999;">&nbsp;</div>');var y=2;var w=1;n.after('<div style="position:absolute;left:'+(b-1)+"px;top:"+(m-k/2-w)+"px;border-left:"+(a-0+y)+"px solid "+c.bc+";border-bottom:"+(k/2+w)+"px solid transparent;border-top:"+(k/2+w)+'px solid transparent;height:0;width:0;z-index:99999999999;"></div>')}else{if(c.cop==3){b=v.left+d.outerWidth()+10+(c.col-0);m=v.top+d.outerHeight()/2+(c.cot-0);u=b+a;t=m;n.css({position:"absolute",top:t+"px",left:u+"px"});n.after('<div id="__ss_notif_arr1" style="position:absolute;left:'+(b+1)+"px;top:"+(m-k/2)+"px;border-right:"+a+"px solid "+c.bgc+";border-bottom:"+(k/2)+"px solid transparent;border-top:"+(k/2)+'px solid transparent;height:0;width:0;z-index:99999999999;">&nbsp;</div>');var y=2;var w=1;n.after('<div id="__ss_notif_arr2" style="position:absolute;left:'+(b+1-y)+"px;top:"+(m-k/2-w)+"px;border-right:"+(a-0+y)+"px solid "+c.bc+";border-bottom:"+(k/2+w)+"px solid transparent;border-top:"+(k/2+w)+'px solid transparent;height:0;width:0;z-index:99999999999;"></div>');n.on("updatepos",function(){d=f(c.coe);if(d.length==0){return}v=d.offset();b=v.left+d.outerWidth()+10+(c.col-0);m=v.top+d.outerHeight()/2+(c.cot-0);u=b+a;t=m;t=m;n.css({position:"absolute",top:t+"px",left:u+"px"});f("#__ss_notif_arr1").css({left:(b+1)+"px",top:(m-k/2)+"px"});f("#__ss_notif_arr2").css({left:(b+1-y)+"px",top:(m-k/2-w)+"px"})})}else{if(c.cop==4){b=v.left+d.outerWidth()/2+(c.col-0);m=v.top+d.outerHeight()+10+(c.cot-0);if(c.io){u=b-c.cimgw/2}else{u=b-c.w/2}t=m+k;n.css({position:"absolute",top:t+"px",left:u+"px"});n.after('<div style="position:absolute;left:'+(b-a/2)+"px;top:"+(m+1)+"px;border-bottom:"+k+"px solid "+c.bgc+";border-left:"+(a/2)+"px solid transparent;border-right:"+(a/2)+'px solid transparent;height:0;width:0;z-index:99999999999;">&nbsp;</div>');var w=2;var y=1;n.after('<div style="position:absolute;left:'+(b-(a/2)-y)+"px;top:"+(m+1-w)+"px;border-bottom:"+(k+w)+"px solid "+c.bc+";border-left:"+(a/2+y)+"px solid transparent;border-right:"+(a/2+y)+'px solid transparent;height:0;width:0;z-index:99999999999;"></div>')}}}}}}}}n.data("srchtml",e+j.html()+"</body></html>");var r=function(){for(var B=0;B<n.contents().find("img").length;B++){if(!n.contents().find("img")[B].complete){setTimeout(r,250);return}}var A=n.contents().find("body").height();var z=f(window).height();if(A>=z){A=(z*90)/100;n.contents().find("body").css("overflow","scroll")}n.height(A);if(c.nst==1){n.css("margin-top","-"+(A/2)+"px")}else{if(c.nst==3){if(c.cop==1){n.css("margin-top","-"+(A+2)+"px")}else{if(c.cop==2||c.cop==3){n.css("margin-top","-"+(A/2)+"px")}else{if(c.cop==4){n.css("margin-top","0")}}}n.data("updateint",setInterval(function(){n.trigger("updatepos")},250))}}if(c.nst==2&&c.pos=="1"){f("#__ss_notif_pad").height(A+2)}n.css("visibility","visible");if(f(".gmg_notif_overlay").length>0){f(".gmg_notif_overlay").css("display","block")}};n.css("visibility","hidden");if(f(".gmg_notif_overlay").length>0){f(".gmg_notif_overlay").css("display","none")}n.load(r);n.get(0).src='javascript:parent.SecondScreenUtils.$("#__ss_notif_frame_'+c.nst+'").data("srchtml")'};var _ss_track=_ss_track||{};_ss_track.id=_ss_track.id||"00000000-0000-0000-0000-000000000000";if(_ss_track.api){_ss_track.events=_ss_track.api}else{_ss_track.events=_ss_track.events||[]}_ss_track.handlers=_ss_track.handlers||[];_ss_track.alarms=_ss_track.alarms||[];_ss_track.options=_ss_track.options||{};_ss_track.options.pre_greet="Please provide your details.";_ss_track.options.online_title="Chat with us!";_ss_track.options.online_greet="Enter your message and one of our agents will attend to you right away.";_ss_track.options.offline_title="Leave us a message!";_ss_track.options.offline_greet="We are now offline. Please leave a message and we will get back to you.";_ss_track.options.unavail_title="We are offline";_ss_track.options.unavail_greet="Live chat is now offline. Please check back later when we are online and our support team will be happy to assist you.";_ss_track.options.msg_hint="Type your message and press ENTER";_ss_track.options.title_color="#3C3B37";_ss_track.options.title_text_color="#fff";_ss_track.options.chat_pos=0;_ss_track.options.chat_pos_off=3;_ss_track.options.chat_close=false;_ss_track.options.mask_fields="";_ss_track.options.vdataprops=[];_ss_track.options.vis_dflt_show=true;_ss_track.options.chat_css="";_ss_track.options.chat_size=0;_ss_track.options.img_enable=false;_ss_track.options.chat_no_min=_ss_track.options.chat_no_min||false;if(document.getElementById("__ss")){var l=document.createElement("a");l.href=document.getElementById("__ss").src;if(l.host==""){l.href=l.href}_ss_track.FE_SERVER=l.host;_ss_track.GMG_SERVER=_ss_track.GMG_SERVER||"www.gsecondscreen.com";_ss_track.VI_SERVER="ae.gsecondscreen.com";if(l.host.search("gamooga.com")==-1&&l.host.search("cloudfront.net")==-1&&l.host.search("gsecondscreen.com")==-1){_ss_track.DEV=true;_ss_track.GMG_SERVER=_ss_track.FE_SERVER;_ss_track.VI_SERVER=_ss_track.FE_SERVER}}WEB_SOCKET_SWF_LOCATION="//"+_ss_track.FE_SERVER+"/static/js/WebSocketMainInsecure.swf";(function(b){if(typeof WebSocket=="undefined"||typeof JSON=="undefined"||typeof localStorage=="undefined"||typeof sessionStorage=="undefined"){return}if(typeof jQuery==="undefined"||jQuery.fn.jquery<"1.7.2"||jQuery.fn.jquery>="1.9"){var a=document.createElement("SCRIPT");a.type="text/javascript";a.src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js";if(a.readyState){a.onreadystatechange=function(){if(this.readyState=="complete"||this.readyState=="loaded"){this.onreadystatechange=null;SecondScreenUtils.$=$.noConflict(true);b(SecondScreenUtils.$)}}}else{a.onload=function(){SecondScreenUtils.$=$.noConflict(true);b(SecondScreenUtils.$)}}document.getElementsByTagName("HEAD")[0].appendChild(a)}else{SecondScreenUtils.$=jQuery;b(jQuery)}})(function(g){if(typeof Prototype!=="undefined"&&Prototype.Version.substr(0,3)=="1.6"){var r=JSON.stringify;JSON.stringify=function(C){var A=Array.prototype.toJSON;delete Array.prototype.toJSON;var B=r(C);Array.prototype.toJSON=A;return B}}function a(A){return(document.cookie.match("(^|; )"+A+"=([^;]*)")||0)[2]}var z=function(A,B){return function(){return B.apply(A,arguments)}};var h=_ss_track.DEV?"_ssd_s":"_ss_s";var f=_ss_track.DEV?"_ssd_v":"_ss_v";var o=location.hostname.split(".");var p=(o[o.length-2].length==2)?o.length-3:o.length-2;var e=_ss_track.DEV?"":";domain="+o.slice(p).join(".");var q=a(h)||0;var j=a(f)||0;var w=function(){return g.ajax({type:"GET",url:"//"+_ss_track.GMG_SERVER+"/nv/"+_ss_track.id+"/",dataType:"jsonp",jsonpCallback:"_ss_on_ajax_nv"})};var x=function(){return g.ajax({type:"GET",url:"//"+_ss_track.VI_SERVER+"/vi/",dataType:"jsonp",jsonpCallback:"_ss_on_ajax_vi"}).pipe(null,function(){var A=g.Deferred();A.resolveWith(this,[{location:"(none)",IP:"(none)",browser:"(none)",OS:"(none)"},"default data",null]);return A})};var c=function(){return g.ajax({type:"GET",url:"//"+_ss_track.FE_SERVER+"/conf/"+_ss_track.id+"/",dataType:"jsonp",jsonpCallback:"_ss_on_ajax_conf"})};var b=function(B){var A=B[0];document.cookie=f+"="+A+";path=/;max-age=630720000;expires="+new Date((new Date().getTime())+630720000000).toUTCString()+e;return A};var d=function(A,D){var F=A[0];var B="";if(document.referrer){try{B=document.referrer.match(/:\/\/(.+)/)[1]}catch(E){B="Direct"}}else{B="Direct"}var C={location:F.location,IP:F.IP,browser:F.browser,OS:F.OS,referrer:B};if(D){C.repeat="No"}else{C.repeat="Yes"}document.cookie=h+"="+SecondScreenUtils.base64encode(JSON.stringify(C))+";path=/;max-age=1800;expires="+new Date((new Date().getTime())+1800000).toUTCString()+e;return C};var t=function(M){var B=M[0];if(typeof B.custom_event_script!="undefined"){var N=document.createElement("script");N.type="text/javascript";N.text=B.custom_event_script;N.id="__ss_ces";var H=document.getElementsByTagName("script")[0];H.parentNode.insertBefore(N,H)}if(typeof _ss_track.options.disable_chat=="undefined"&&typeof _ss_track.options.chat_show=="undefined"){if(B.settings["dcw"]){_ss_track.options.disable_chat=B.settings["dcw"];if(B.settings["eca"]){_ss_track.options.enable_chat_by_agent=B.settings["eca"]}}if(B.settings["ep"]){_ss_track.options.enable_prechat=true}if(B.settings["dom"]){_ss_track.options.disable_offline_message=B.settings["dom"];if(B.settings["enoffun"]){_ss_track.options.enable_unavail_greet=B.settings["enoffun"]}}var I=function(O){return g("<div/>").text(O).html()};_ss_track.options.pre_greet=I(B.settings["prgrt"]);_ss_track.options.online_title=I(B.settings["ontit"]);_ss_track.options.online_greet=I(B.settings["ongrt"]);_ss_track.options.offline_title=I(B.settings["offtit"]);_ss_track.options.offline_greet=I(B.settings["offgrt"]);_ss_track.options.msg_hint=I(B.settings["msghint"]);_ss_track.options.unavail_title=I(B.settings["offuntitle"]);_ss_track.options.unavail_greet=I(B.settings["offungreet"]);_ss_track.options.chat_pos=parseInt(B.settings["chps"]);_ss_track.options.chat_pos_off=parseInt(B.settings["chpsoff"]);_ss_track.options.chat_close=B.settings["cc"];_ss_track.options.mask_fields=B.settings["mskfl"];_ss_track.options.vdataprops=B.settings["vdp"];_ss_track.options.vis_dflt_show=B.settings["vds"];_ss_track.options.chat_css=B.settings["chcss"];_ss_track.options.chat_size=B.settings["chsize"];_ss_track.options.img_enable=B.settings["imen"];var K=_ss_track.options.title_color=B.settings["titcl"];var A=parseInt(K.substr(1,2),16);var G=parseInt(K.substr(3,2),16);var L=parseInt(K.substr(5,2),16);var C=1-(0.299*A+0.587*G+0.114*L)/255;if(C<0.5){_ss_track.options.title_text_color="#000"}else{_ss_track.options.title_text_color="#fff"}}if(typeof B.evt!="undefined"){var F=function(Y,aa){var X={};var P=false;for(var R=0;R<Y.kv.length;R++){var W=Y.kv[R];var Z=W[0];var O="???";if(W[1]=="1"){O=W[2]}else{if(W[1]=="5"){try{O=new Function("return ("+W[2]+")();")()}catch(V){P=true;break}}else{if(W[1]>="2"){var U;if(W[1]=="3"){var S=W[2].split("|");var T=g(aa);for(var Q=0;Q<S[0]-0;Q++){T=T.parent()}if(S[1]==""){U=g(T)}else{U=g(S[1],T)}}else{U=g(W[2])}if(U.length>0){if(U.prop("tagName")=="SELECT"){O=g("option:selected",U).text()}else{O=U.val()||U.text()}}else{P=true;break}}}}O=g.trim(O);if(O.length>102){O=O.substr(0,100)+"..."}X[Z]=O}if(!P){_ss_track.events.push([Y.n,X,Y.t])}};var J=function(O,P){(function(){var R=O;var Q=P;if(typeof R.p!="undefined"){setTimeout(function(){if(g(R.p).filter(":visible").length>0){F(R,Q)}},R.wt*1000)}else{F(R,Q)}})()};for(var E=0;E<B.evt.length;E++){var D=B.evt[E];(function(){var P=D;var O=window.location.pathname+window.location.search+window.location.hash;if((P.ut==1&&O==P.u)||(P.ut==2&&O.indexOf(P.u)==0)||(P.ut==3&&O.indexOf(P.u)!=-1)||(P.ut==5&&O.indexOf(P.u)==-1)||(P.ut==4&&new RegExp(P.u).test(O))){if(P.w==1){g(document).ready(function(){J(P)})}else{if(P.w>=2&&P.w<=5){g(document).on("mousedown.__ss_ec",P.c,function(){J(P,this)})}else{if(P.w==6){g(document).ready(function(){setTimeout(function(){J(P)},parseInt(P.c)*1000)})}else{if(P.w==7){g(document).ready(function(){var T=parseInt(P.c)*1000;var R=new Date().getTime()+T;var S=function(U){setTimeout(function(){var V=new Date().getTime()-R;if(V>=0){J(P)}else{S(-V)}},U)};var Q=function(){R=new Date().getTime()+T};g(document).on("mousedown.__ss_ec keydown.__ss_ec",Q);S(T)})}}}}}})()}}return B};var y=function(C,D,B,A){if(window!=window.top){return}if(_ss_track.DEV){SecondScreen._xds=new SecondScreenUtils.xds("http://"+_ss_track.GMG_SERVER+"/static/xds-serve.html")}else{SecondScreen._xds=new SecondScreenUtils.xds("https://xds.gsecondscreen.com/xds/")}if(_ss_track.options.chat_pos>=2&&/(Android|webOS|iPhone|iPad|iPod|BlackBerry|Windows Phone)/g.test(navigator.userAgent)){_ss_track.options.chat_pos=0}SecondScreen._xds.getSSAllItems(function(G){SecondScreen._sstore=G;if(window.opener){SecondScreen._del_sess_data("__ss_vid")}if(window.location.hash.indexOf("#__ss_event_conf=")==0){var E=parseInt(window.location.hash.split("=")[1]);SecondScreen._write_sess_data("event_conf",E);window.location.href=window.location.href.split("#")[0];return}if(SecondScreen._read_sess_data("event_conf")!==null){(function(){var I=document.createElement("script");I.type="text/javascript";I.async=true;I.id="__ss";I.src="//"+_ss_track.GMG_SERVER+"/static/sseventconf.min.js";var H=document.getElementsByTagName("script")[0];H.parentNode.insertBefore(I,H)})();_ss_track.event_conf=D.evt;return}if(window.location.hash.indexOf("#__ss_notif_view=")==0){var F=JSON.parse(decodeURIComponent(window.location.hash.split("=")[1]));SecondScreen._show_notification(F);return}if(D.settings["bips"].join(",").indexOf(B.IP)!=-1){return}_ss_track.api=new SecondScreen(C,_ss_track.id,D,B,_ss_track.events,_ss_track.handlers,_ss_track.alarms,A);_ss_track.events={};_ss_track.handlers={};_ss_track.alarms={};_ss_track.events.push=z(_ss_track.api,_ss_track.api.push_event);_ss_track.handlers.push=z(_ss_track.api,_ss_track.api.push_handler);_ss_track.alarms.push=z(_ss_track.api,_ss_track.api.push_alarm)})};if(j==0){var v=w();var u=x();var k=c();_ss_track.options.visitor_name="";_ss_track.options.visitor_email="";g.when(u,k,v).done(function(D,A,F){var C=d(D,true);var B=b(F);var E=t(A);y(B,E,C,true)})}else{if(q==0){var u=x();var k=c();var s;var n=j.indexOf("|");if(n==-1){s=j;_ss_track.options.visitor_name="";_ss_track.options.visitor_email=""}else{s=j.substring(0,n);var m=j.substring(n+1);var i=JSON.parse(SecondScreenUtils.base64decode(m));_ss_track.options.visitor_name=i.name;_ss_track.options.visitor_email=i.email}g.when(u,k).done(function(C,A){var B=d(C,false);var D=t(A);y(s,D,B,true)})}else{var k=c();var s;var n=j.indexOf("|");if(n==-1){s=j;_ss_track.options.visitor_name="";_ss_track.options.visitor_email=""}else{s=j.substring(0,n);var m=j.substring(n+1);var i=JSON.parse(SecondScreenUtils.base64decode(m));_ss_track.options.visitor_name=i.name;_ss_track.options.visitor_email=i.email}k.done(function(C,E,B){document.cookie=h+"="+q+";path=/;max-age=1800;expires="+new Date((new Date().getTime())+1800000).toUTCString()+e;var A=JSON.parse(SecondScreenUtils.base64decode(q));var D=t([C,E,B]);y(s,D,A,false)})}}});